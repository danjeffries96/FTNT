% For double-blind review submission, w/o CCS and ACM Reference (max
% submission space)
\documentclass[acmsmall,review,anonymous]{acmart}
\settopmatter{printfolios=true,printccs=false,printacmref=false}
%% For double-blind review submission, w/ CCS and ACM Reference
%\documentclass[acmsmall,review,anonymous]{acmart}\settopmatter{printfolios=true}
%% For single-blind review submission, w/o CCS and ACM Reference (max submission space)
%\documentclass[acmsmall,review]{acmart}\settopmatter{printfolios=true,printccs=false,printacmref=false}
%% For single-blind review submission, w/ CCS and ACM Reference
%\documentclass[acmsmall,review]{acmart}\settopmatter{printfolios=true}
%% For final camera-ready submission, w/ required CCS and ACM Reference
%\documentclass[acmsmall]{acmart}\settopmatter{}


%% Journal information
%% Supplied to authors by publisher for camera-ready submission;
%% use defaults for review submission.
\acmJournal{PACMPL}
\acmVolume{1}
\acmNumber{POPL} % CONF = POPL or ICFP or OOPSLA
\acmArticle{1}
\acmYear{2020}
\acmMonth{1}
\acmDOI{} % \acmDOI{10.1145/nnnnnnn.nnnnnnn}
\startPage{1}

%% Copyright information
%% Supplied to authors (based on authors' rights management selection;
%% see authors.acm.org) by publisher for camera-ready submission;
%% use 'none' for review submission.
\setcopyright{none}
%\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\copyrightyear{2018}           %% If different from \acmYear

%% Bibliography style
\bibliographystyle{ACM-Reference-Format}
%% Citation style
%% Note: author/year citations are required for papers published as an
%% issue of PACMPL.
\citestyle{acmauthoryear}   %% For author/year citations
%\citestyle{acmnumeric}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Note: Authors migrating a paper from PACMPL format to traditional
%% SIGPLAN proceedings format must update the '\documentclass' and
%% topmatter commands above; see 'acmart-sigplanproc-template.tex'.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\usepackage[utf8]{inputenc}
\usepackage{ccicons}
\usepackage{verbatim}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amscd}
%\usepackage{MnSymbol}
\usepackage{xcolor}

\usepackage{bbold}
\usepackage{url}
\usepackage{upgreek}
%\usepackage{stmaryrd}

\usepackage{lipsum}
\usepackage{tikz-cd}
\usetikzlibrary{cd}
\usetikzlibrary{calc}
\usetikzlibrary{arrows}

\usepackage{bussproofs}
\EnableBpAbbreviations

\input{macros}
\input{mytheorem}

\theoremstyle{definition}
\newtheorem{exmpl}{Example}

\renewcommand{\greyout}[1]{} %{{\color{gray} {#1}}} -- toggle to remove greyed text

\newcommand{\new}[1]{{\color{blue} {#1}}}


\newcommand{\emptyfun}{{[]}}
\newcommand{\cal}{\mathcal}
%\newcommand{\fold}{\mathit{fold}}
\newcommand{\F}{\mathcal{F}}
\renewcommand{\G}{\mathcal{G}}
\newcommand{\N}{\mathcal{N}}
\newcommand{\E}{\mathcal{E}}
\newcommand{\B}{\mathcal{B}}
\renewcommand{\P}{\mathcal{A}}
\newcommand{\pred}{\mathsf{Fam}}
\newcommand{\env}{\mathsf{Env}}
\newcommand{\set}{\mathsf{Set}}
\renewcommand{\S}{\mathcal S}
\renewcommand{\C}{\mathcal{C}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\A}{\mathcal{A}}
\renewcommand{\id}{\mathit{id}}
\newcommand{\map}{\mathsf{map}}
\newcommand{\pid}{\underline{\mathit{id}}}
\newcommand{\pcirc}{\,\underline{\circ}\,}
\newcommand{\pzero}{\underline{0}}
\newcommand{\pone}{\underline{1}}
\newcommand{\psum}{\,\underline{+}\,}
\newcommand{\pinl}{\underline{\mathit{inL}}\,}
\newcommand{\pinr}{\underline{\mathit{inR}}\,}
\newcommand{\ptimes}{\,\underline{\times}\,}
\newcommand{\ppi}{\underline{\pi_1}}
\newcommand{\pppi}{\underline{\pi_2}}
\newcommand{\pmu}{\underline{\mu}}
\newcommand{\semmap}{\mathit{map}}
\newcommand{\subst}{\mathit{subst}}

\newcommand{\tb}[1]{~~ \mbox{#1} ~~}
\newcommand{\listt}[1]{(\mu \phi. \lambda \beta . \onet + \beta \times
  \phi \beta) #1} 
\newcommand{\filtype}{\Nat^\emptyset 
 (\Nat^\emptyset \, \alpha \, \mathit{Bool})\, (\Nat^\emptyset 
  (List \, \alpha) \, (List \, \alpha))} 
\newcommand{\filtypeGRose}{\Nat^\emptyset 
 (\Nat^\emptyset \, \alpha \, \mathit{Bool})\, (\Nat^\emptyset 
  (\mathit{GRose}\,\psi \, \alpha) \, (\mathit{GRose}\,\psi \, (\alpha
  + \onet)))} 
\newcommand{\maplist}{\mathit{map}_{\lambda A. \setsem{\emptyset; \alpha
      \vdash \mathit{List} \, \alpha} \rho[\alpha := A]}} 
\newcommand{\PLeaves}{\mathsf{PLeaves}}
\newcommand{\swap}{\mathsf{swap}}
\newcommand{\reverse}{\mathsf{reverse}}
\newcommand{\Bcons}{\mathit{Bcons}}
\newcommand{\Bnil}{\mathit{Bnil}}

\title[Practical Parametricity for GADTs]{Practical Parametricity for GADTs}
  %Primitive
  %% [Short Title] is optional; when present,
                         %% will be used in header instead of Full
                         %% Title.
%\titlenote{with title note}             %% \titlenote is optional;
                                        %% can be repeated if necessary;
                                        %% contents suppressed with 'anonymous'
%\subtitle{Subtitle}                     %% \subtitle is optional
%\subtitlenote{with subtitle note}       %% \subtitlenote is optional;
                                        %% can be repeated if necessary;
                                        %% contents suppressed with 'anonymous'


%% Author information
%% Contents and number of authors suppressed with 'anonymous'.
%% Each author should be introduced by \author, followed by
%% \authornote (optional), \orcid (optional), \affiliation, and
%% \email.
%% An author may have multiple affiliations and/or emails; repeat the
%% appropriate command.
%% Many elements are not rendered, but should be provided for metadata
%% extraction tools.

%% Author with single affiliation.
\author{Patricia Johann, Enrico Ghiorzi, and Daniel Jeffries}
%\authornote{with author1 note}          %% \authornote is optional;
%                                        %% can be repeated if necessary
%\orcid{nnnn-nnnn-nnnn-nnnn}             %% \orcid is optional
\affiliation{
%  \position{Position1}
%  \department{Department1}              %% \department is recommended
  \institution{Appalachian State University}            %% \institution is required
%  \streetaddress{Street1 Address1}
%  \city{City1}
%  \state{State1}
%  \postcode{Post-Code1}
%  \country{Country1}                    %% \country is recommended
}
\email{johannp@appstate.edu, ghiorzie@appstate.edu, jeffriesd@appstate.edu}          %% \email is recommended


\begin{document}

\begin{abstract}
Abstract goes here
\end{abstract}

%\begin{CCSXML}
%<ccs2012>
%<concept>
%<concept_id>10011007.10011006.10011008</concept_id>
%<concept_desc>Software and its engineering~General programming languages</concept_desc>
%<concept_significance>500</concept_significance>
%</concept>
%<concept>
%<concept_id>10003456.10003457.10003521.10003525</concept_id>
%<concept_desc>Social and professional topics~History of programming languages</concept_desc>
%<concept_significance>300</concept_significance>
%</concept>
%</ccs2012>
%\end{CCSXML}
%
%\ccsdesc[500]{Software and its engineering~General programming languages}
%\ccsdesc[300]{Social and professional topics~History of programming languages}
%% End of generated code


%% Keywords
%% comma separated list
%\keywords{keyword1, keyword2, keyword3}  %% \keywords is optional


\maketitle

\new{Maybe develop our theory for {\em any} $\lambda \geq \omega_1$,
  and then specialize to $\omega_1$ when discussing GADTs? Can we do
  that? It seems we really use properties of $\oCPO$ to get that
  interpretations of $\Nat$-types are well-defined.}

\section{The Calculus}

\subsection{Types}\label{sec:types}

For each $k \ge 0$, we assume countable sets $\tvars^k$ of \emph{type
  constructor variables of arity $k$} and $\fvars^k$ of
\emph{functorial variables of arity $k$}, all mutually disjoint.
%disjoint for distinct $k$ and disjoint from each other.
The sets of all type constructor variables and functorial variables
are $\tvars = \bigcup_{k \ge 0} \tvars^k$ and $\fvars = \bigcup_{k \ge
  0} \fvars^k$, respectively, and a \emph{type variable} is any
element of $\tvars \cup \fvars$.  We use lower case Greek letters for
type variables, writing $\phi^k$ to indicate that $\phi \in \tvars^k
\cup \fvars^k$, and omitting the arity indicator $k$ when convenient,
unimportant, or clear from context. We reserve letters from the
beginning of the alphabet to denote type variables of arity $0$, i.e.,
elements of $\tvars^0 \cup \fvars^0$. We write $\overline{\zeta}$ for
either a set $\{\zeta_1,...,\zeta_n\}$ of type constructor variables
or a set of functorial variables when the cardinality $n$ of the set
is unimportant or clear from context. If $\Pos\,$ is a set of type
variables we write $\Pos, \overline{\phi}$ for $\Pos\, \cup
\overline{\phi}$ when $\Pos\, \cap \overline{\phi} = \emptyset$.  We
omit the vector notation for a singleton set, thus writing $\phi$,
instead of $\overline{\phi}$, for $\{\phi\}$.
\begin{dfn}
Let $V$ be a finite subset of\, $\tvars$, $\Pos$ be a finite
subset of\, $\fvars$, $\overline{\alpha}$ be a finite subset of\,
$\fvars^0$ disjoint from $\Pos$, and $\phi^k \in \fvars^k
\setminus \Pos$.  The set $\mcF^\Pos(V)$ of {\em functorial
  expressions} over $\Pos$ and $V$ are given by
\begin{align*}
  \mcF^\Pos(V) \; ::= \; 
  & \hspace*{0.15in}
\zerot \mid \onet 
\mid \Nat^\Pos \, \mcF^\Pos (V) \;
\mcF^\Pos (V) 
\mid \Pos\; \ol{\mcF^\Pos(V)}  \,
\mid V\, \ol{\mcF^\Pos(V)}  
\mid \mcF^{\Pos}(V) + \mcF^\Pos(V)\\
&\mid \mcF^{\Pos}(V) \times \mcF^\Pos(V) \mid \left(\mu
\phi^{~k}. \lambda \alpha_1...\alpha_k.  
\mcF^{\Pos,\alpha_1,...,\alpha_k,\phi}(V)\right)
\ol{\mcF^{\Pos}(V)}\\
&\mid (\Lan^{\ol\alpha}_{\ol{\F^{\ol\alpha}}} \F^{\Pos,\ol\alpha})\ol{\F^\Pos}
\end{align*}
\end{dfn}
\noindent
A \emph{type} over $\Pos$ and $V$ is any element of $\F^\Pos(V)$. The
difference with~\cite{jgj20} here lies solely in the incorporation of
functorial expressions constructed from $\Lan$.

The notation for types entails that an application $F F_1...F_k$ is
allowed only when $F$ is a type variable of arity $k$, or $F$ is a
subexpression of the form $\mu \phi^{k}.\lambda
\alpha_1...\alpha_k.F'$ or $\Lan^{\ol\alpha}_{\ol K}\, F'$. Moreover,
if $F$ has arity $k$ then $F$ must be applied to exactly $k$
arguments.  Accordingly, an overbar indicates a sequence of
subexpressions whose length matches the arity of the type applied to
it.  The fact that types are always in \emph{$\eta$-long normal form}
avoids having to consider $\beta$-conversion at the level of types. In
a subexpression $\Nat^\Phi F\,G$, the $\Nat$ operator binds all
occurrences of the variables in $\Phi$ in $F$ and $G$. Note that, by
contrast with~\cite{jgj20}, variables of arity greater than $0$ are
allowed in $\Phi$; this is necessary to construct well-typed terms of
$\Lan$ types. In a subexpression $\mu \phi^k.\lambda \ol{\alpha}.F$,
the $\mu$ operator binds all occurrences of the variable $\phi$, and
the $\lambda$ operator binds all occurrences of the variables in
$\ol{\alpha}$, in the body $F$. And in a subexpression
$(\Lan^{\ol\alpha}_{\ol K}\, F)\ol A$, the $\Lan$ operator binds all
occurrences of the variables in $\ol\alpha$ in every element of $\ol
K$, as well as in $F$.

A {\em type constructor context} is a finite set $\Gamma$ of type
constructor variables, and a {\em functorial context} is a finite set
$\Phi$ of functorial variables. In Definition~\ref{def:wftypes}, a
judgment of the form $\Gamma;\Phi \vdash F$ indicates that the
type $F$ is intended to be functorial in the variables in $\Phi$
but not necessarily in those in $\Gamma$.

\begin{dfn}\label{def:wftypes}
The formation rules for the set $\F \subseteq \bigcup_{V \subseteq
  \tvars, \Pos\, \subseteq \fvars}\F^\Pos(V)$ of\, {\em well-formed
  types} are

\[\begin{array}{cc}
\AXC{\phantom{$\Gamma,\Phi$}}
\UIC{$\Gamma;\Phi \vdash \zerot$}
\DisplayProof
&
\AXC{\phantom{$\Gamma,\Phi$}}
\UIC{$\Gamma;\Phi \vdash \onet$}
\DisplayProof
\end{array}\]

\vspace*{0.1in}

\[\begin{array}{cc}
\AXC{$\Gamma;\Phi \vdash F$}
\AXC{$\Gamma;\Phi \vdash G$}
\BIC{$\Gamma; \Phi \vdash F + G$}
\DisplayProof
&
\AXC{$\Gamma;\Phi \vdash F$}
\AXC{$\Gamma;\Phi \vdash G$}
\BIC{$\Gamma; \Phi \vdash F \times G$}
\DisplayProof
\end{array}\]

\vspace*{0.05in}

\[\begin{array}{c}
\AXC{$\Gamma;\Phi \vdash F$}
\AXC{$\Gamma;\Phi  \vdash G$}
\BIC{$\Gamma;\emptyset \vdash \Nat^\Phi F \,G$}
\DisplayProof
\\[4ex]
\AXC{$\phi^k \in \Gamma \cup \Phi$}
\AXC{$\quad\quad\ol{\Gamma;\Phi \vdash F}$}
\BIC{$\Gamma;\Phi \vdash \phi^k \ol{F}$}
\DisplayProof
\\[3ex]
\AXC{$\Gamma;\ol{\gamma^0},\ol{\alpha^0},\phi^k \vdash F$}
\AXC{$\quad\quad\ol{\Gamma;\Phi,\ol{\gamma^0} \vdash G}$}
\BIC{$\Gamma;\Phi,\ol{\gamma^0} \vdash (\mu \phi^k.\lambda
  \ol{\alpha^0}. \,F)\,\ol{G}$} 
\DisplayProof
\\[5ex]
\AXC{$\Gamma; \Phi,\ol\alpha^0 \vdash F$}
\AXC{$\ol{\Gamma;\ol\alpha^0 \vdash K}$}
\AXC{$\ol{\Gamma;\Phi \vdash A}$}
\TIC{$\Gamma;\Phi \vdash (\Lan^{\ol{\alpha^0}}_{\ol K} F)\, \ol A$}
\DisplayProof
\end{array}\]
\end{dfn}

In addition to textual replacement, we also have a proper substitution
operation on types. If $F$ is a type over $P$ and $V$, if $\Pos$
and $V$ contain only type variables of arity $0$, and if $k=0$ for
every occurrence of $\phi^k$ bound by $\mu$ in $F$, then we say
that $F$ is {\em first-order}; otherwise we say that $F$ is {\em
  second-order}.  Substitution for first-order types is the usual
capture-avoiding textual substitution. We write $F[\alpha :=
  \sigma]$ for the result of substituting $\sigma$ for $\alpha$ in
$F$, and $F[\alpha_1 := F_1,...,\alpha_k := F_k]$, or
$F[\ol{\alpha := F}]$ when convenient, for $F[\alpha_1 :=
  F_1][\alpha_2 := F_2,...,\alpha_k := F_k]$. Substitution
for second-order types is defined below, where we adopt a similar
notational convention for vectors of types. Note that it is not
correct to substitute along non-functorial variables.

\begin{dfn}\label{def:second-order-subst}
If \,$\Gamma; \Phi,\phi^k \vdash H$
%with $k \geq 1$,
and if\, $\Gamma;\Phi, \ol{\alpha} \vdash F$ with
$|\ol\alpha| = k$, then $\Gamma;\Phi \vdash H[\phi :=_{\ol{\alpha}}
  F]$.  Similarly, if \,$\Gamma, \phi^k; \Phi \vdash H$,
%with $k \geq 1$,
and if\, $\Gamma; \ol\psi,\ol{\alpha} \vdash F$ with $|\ol\alpha| = k$
and $\Phi \cap \ol\psi = \emptyset$, then $\Gamma,\ol\psi';\Phi \vdash
H[\phi :=_{\ol{\alpha}} F[\ol{\psi :== \psi'}]]$. Here, the operation
  $(\cdot)[\phi :=_{\ol \alpha} F]$ of {\em second-order type
    substitution along $\ol\alpha$} is defined by:
\[\begin{array}{lll}
\zerot[\phi :=_{\ol{\alpha}} F] & = & \zerot\\[0.5ex]
\onet[\phi :=_{\ol{\alpha}} F] & = & \onet\\[0.25ex]
(\Nat^{\ol\beta} G \,K)[\phi :=_{\ol{\alpha}} F]
& = & \Nat^{\ol\beta}\, (G[\phi :=_{\ol{\alpha}} F]) \,(K[\phi
  :=_{\ol{\alpha}} F])\\
(\psi\ol{G})[\phi :=_{\ol{\alpha}} F] & = &
\left\{\begin{array}{ll}
\psi \,\ol{G[\phi :=_{\ol{\alpha}} F]} & \mbox{if } \psi \not = \phi\\
  F[\ol{\alpha  := G[\phi :=_{\ol{\alpha}} F]}] 
  & \mbox{if } \psi = \phi
\end{array}\right.\\[2.8ex]
(G + K)[\phi :=_{\ol{\alpha}} F] & = & G[\phi
  :=_{\ol{\alpha}} F] + K[\phi :=_{\ol{\alpha}} F]\\[0.5ex] 
(G \times K)[\phi :=_{\ol{\alpha}} F] & = &
G[\phi :=_{\ol{\alpha}} F] \times K[\phi
  :=_{\ol{\alpha}} F]\\[0.5ex]   
((\mu \psi. \lambda \ol{\beta}.\, G)\ol{K})[\phi :=_{\ol{\alpha}}
  F] & = & (\mu \psi. \lambda \ol{\beta}. \,G[\phi :=_{\ol{\alpha}}
  F])\, \ol{K[\phi :=_{\ol{\alpha}} F]}\\[0.5ex]
((\Lan^{\ol{\beta}}_{\ol H}\, G)\ol{K})[\phi :=_{\ol{\alpha}}
  F] & = & (\Lan^{\ol\beta}_{\ol H} \,G[\phi :=_{\ol{\alpha}}
  F])\, \ol{K[\phi :=_{\ol{\alpha}} F]}
\end{array}\]
\end{dfn}
\noindent
We note that $(\cdot)[\phi^0 :=_\emptyset F]$ coincides with
first-order substitution. We also omit $\ol\alpha$ when convenient.

\subsection{Terms}\label{sec:terms}

We now define our term calculus. To do so we assume an infinite set
$\cal V$ of term variables disjoint from $\tvars$ and $\fvars$. If
$\Gamma$ is a type constructor context and $\Phi$ is a functorial
context, then a {\em term context for $\Gamma$ and $\Phi$} is a finite
set of bindings of the form $x : F$, where $x \in {\cal V}$ and
$\Gamma; \Phi \vdash F$. We adopt the same conventions for denoting
disjoint unions and for vectors in term contexts as for type
constructor contexts and functorial contexts.

\begin{dfn}\label{def:well-formed-terms}
Let $\Delta$ be a term context for $\Gamma$ and $\Phi$.  The formation
rules for the set of\, {\em well-formed terms over $\Delta$} are
\[\begin{array}{ccc}
\AXC{$\Gamma;\Phi \vdash F$}
\UIC{$\Gamma;\Phi \,|\, \Delta,x :F \vdash x : F$}
\DisplayProof
&
\AXC{$\Gamma;\Phi \,|\, \Delta \vdash t : \zerot$}
\AXC{$\Gamma;\Phi \vdash F$}
\BIC{$\Gamma;\Phi \,|\, \Delta \vdash \bot_F t  : F$}
\DisplayProof
&
\AXC{$\phantom{\Gamma;\Phi}$}
\UIC{$\Gamma;\Phi \,|\, \Delta \vdash \top : \onet$}
\DisplayProof\\\\
\end{array}\]
\[\begin{array}{cc}
\AXC{$\Gamma;\Phi \,|\, \Delta \vdash s: F$}
\UIC{$\Gamma;\Phi \,|\, \Delta \vdash \inl \,s: F + G$}
\DisplayProof
&
\AXC{$\Gamma;\Phi \,|\, \Delta \vdash t : G$}
\UIC{$\Gamma;\Phi \,|\, \Delta \vdash \inr \,t: F + G$}
\DisplayProof\\\\
\end{array}\]
\[\begin{array}{c}
\AXC{$\Gamma; \Phi \vdash F,G$}
\AXC{$\Gamma;\Phi \,|\, \Delta \vdash t : F+G$}
\AXC{$\Gamma;\Phi \,|\, \Delta, x : F \vdash l : K \hspace{0.3in} \Gamma;\Phi \,|\, \Delta, y : G \vdash r : K$}
\TIC{$\Gamma;\Phi~|~\Delta \vdash \case{t}{x \mapsto l}{y \mapsto r} : K$}
\DisplayProof
\end{array}\]

\vspace*{0.05in}

\[\begin{array}{lll}
\AXC{$\Gamma;\Phi \,|\, \Delta \vdash s: F$}
\AXC{$\Gamma;\Phi \,|\, \Delta \vdash t : G$}
\BIC{$\Gamma;\Phi \,|\, \Delta \vdash (s,t) : F \times G$}
\DisplayProof
&
\AXC{$\Gamma;\Phi \,|\, \Delta \vdash t : F \times G$}
\UIC{$\Gamma;\Phi \,|\, \Delta \vdash \pi_1 t : F$}
\DisplayProof
&
\AXC{$\Gamma;\Phi \,|\, \Delta \vdash t : F \times G$}
\UIC{$\Gamma;\Phi \,|\, \Delta \vdash \pi_2 t : G$}
\DisplayProof
\end{array}\]

\vspace*{0.05in}

\[\begin{array}{c}
\AXC{$\Gamma; \Phi \vdash F$}
\AXC{$\Gamma; \Phi \vdash G$}
\AXC{$\Gamma; \Phi \,|\, \Delta, x : F \vdash t: G$} 
\TIC{$\Gamma; \emptyset
  \,|\, \Delta \vdash L_\Phi x.t : \Nat^\Phi \,F \,G$}
\DisplayProof
\\\\
\AXC{$\ol{\Gamma;\Phi,\ol\beta \vdash K}$}
\AXC{$\Gamma; \emptyset
  \,|\, \Delta \vdash t : \Nat^{\ol\psi} \,F \,G$}
\AXC{$\Gamma;\Phi \,|\, \Delta \vdash s: F[\overline{\psi :=_{\ol\beta} K}]$}
\TIC{$\Gamma;\Phi\,|\, \Delta \vdash t_{\ol K} s:
  G[\overline{\psi :=_{\ol\beta} K}]$}
\DisplayProof
\\\\
\AXC{$\Gamma; \Phi, \ol{\phi} \vdash H$}
\AXC{$\ol{\Gamma; \Phi,\ol{\beta} \vdash F}$}
\AXC{$\ol{\Gamma; \Phi,\ol{\beta} \vdash
    G}$}
\TIC{$\Gamma; \emptyset
  ~|~\emptyset
  \vdash \map^{\ol{F},\ol{G}}_H :
  \Nat^\emptyset\;(\ol{\Nat^{\Phi,\ol{\beta}}\,F\,G})\;
  (\Nat^\Phi\,H[\ol{\phi :=_{\ol{\beta}} F}]\;H[\ol{\phi
      :=_{\ol{\beta}} G}])$} 
\DisplayProof
\\\\
\AXC{$\Gamma; \Phi, \phi, \ol{\alpha} \vdash H$}
\UIC{$\Gamma; \emptyset  \,|\, \emptyset \vdash \tin_H :
  \Nat^{\Phi,\ol{\beta}} H[\phi :=_{\ol{\beta}} (\mu
    \phi.\lambda \ol{\alpha}.H)\ol{\beta}][\ol{\alpha := \beta}]\,(\mu
  \phi.\lambda \ol{\alpha}.H)\ol{\beta}$}
\DisplayProof
\\\\
\AXC{$\Gamma; \phi,\Phi,\ol{\alpha} \vdash H$}
\AXC{$\Gamma; \Phi, \ol{\beta} \vdash F$}
\BIC{$\Gamma; \emptyset  \,|\, \emptyset \vdash \fold^F_H :
  \Nat^\emptyset\; (\Nat^{\Phi,\ol{\beta}}\,H[\phi
    :=_{\ol{\beta}} F][\ol{\alpha := \beta}]\,F)\; (\Nat^{\Phi,\ol{\beta}}
    \,(\mu \phi.\lambda \ol{\alpha}.H)\ol{\beta}\,F)$}
\DisplayProof
\\\\
\AXC{$\Gamma; \Phi,\ol{\alpha}\vdash F$}
\AXC{$\ol{\Gamma; \ol{\alpha} \vdash K}$}
\AXC{$\ol{\Gamma;\Phi \vdash A} \hspace*{0.3in} \Gamma;\Phi~|~\Delta \vdash t : F[\ol{\alpha :=A}]$}
\TIC{$\Gamma;\Phi~|~\Delta \vdash \int_{\ol K,F} t :
  (\Lan^{\ol\alpha}_{\ol K}\,  F)\,\ol{K[\ol{\alpha := A}]}$}  
\DisplayProof
\\\\
\AXC{$\Gamma;\emptyset~|~\Delta \vdash \eta : \Nat^{\Phi,\ol\alpha}\,
  F\;G[\ol{\beta := K}]$}
\AXC{$\ol{\Gamma;\Phi \vdash A}$}
\AXC{$\Gamma;\Phi~|~\Delta \vdash t : (\Lan^{\ol\alpha}_{\ol K} F)\,\ol A $}
\TIC{$\Gamma;\Phi~|~\Delta \vdash \partial^{G, \ol K}_F \eta\,t :
  G[\ol{\beta := A}]$}
\DisplayProof
\end{array}\]
\end{dfn}

\vspace*{0.2in}

In the rule for $L_{\ol{\alpha}}x.t$, the $L$ operator binds all
occurrences of the type variables in $\ol{\alpha}$ in the type of the
term variable $x$ and in the body $t$, as well as all occurrences of
$x$ in $t$. In the rule for $t_{\ol K} s$ there is one functorial
expression in $\ol K$ for every functorial variable in $\ol
\alpha$. In the rule for $\map^{\ol{F},\ol{G}}_H$ there is one
functorial expression $F$ and one functorial expression $G$ for each
functorial variable in $\ol\phi$. Moreover, for each $\phi^k$ in
$\ol\phi$ the number of functorial variables in $\ol\beta$ in the
judgments for its corresponding functorial expresssions $F$ and $G$ is
$k$. In the rules for $\tin_H$ and $\fold^F_H$, the functorial
variables in $\ol{\beta}$ are fresh with respect to $H$, and there is
one $\beta$ for every $\alpha$. (Recall from above that, in order for
the types of $\tin_H$ and $\fold^F_H$ to be well-formed, the length of
$\alpha$ must equal the arity of $\phi$.) In the rule for $\int_{\ol
  K,H}\,t$, there is one functorial expression $A$ for every
functorial variable in $\ol \alpha$, and in the rule for
$\partial^{G,\ol K}_F\,\eta\,t$, there is one functorial expression
$A$ for every functorial expression in $\ol K$ (and hence for every
functorial variable in $\ol \beta$).
    

Substitution for terms is the obvious extension
of the usual capture-avoiding textual substitution, and
Definition~\ref{def:well-formed-terms} ensures that the expected
weakening rules for well-formed terms hold.

\vspace*{0.2in}

\new{Sum and product intro and elim rules should be annotated with
  constituent types for consistency?

\vspace*{0.2in}

We should have a computation rule along the lines of: If $\eta :
\Nat^{\ol\alpha} F \,G[\ol{\beta := K}]$ then
\[\begin{array}{ll}
& (\partial_F^{G,\ol K} \eta)_{\ol{K[\ol{\alpha := A}]}} \circ (\int_{K,F})_{\ol
  A}\; \rightarrow \; \eta_{\ol A}\\
: & F[\ol{\alpha := A}] \to G[\ol{\beta := K[\ol{\alpha :=A}]}]\\
= & F[\ol{\alpha := A}] \to G[\ol{\beta := K}][\ol{\alpha := A}]
\end{array}\]
This will appear as a computational property of the term
interpretations.}

\section{Interpreting Types}\label{sec:type-interp}

The fundamental idea underlying Reynolds' parametricity is to give
each type $F(\alpha)$ with one free variable $\alpha$ both an {\em
  object interpretation} $F_0$ taking sets to sets and a
\emph{relational interpretation} $F_1$ taking relations $R :
\rel(A,B)$ to relations $F_1 (R) : \rel(F_0 (A), F_0 (B))$, and to
interpret each term $t(\alpha,x) : F(\alpha)$ with one free term
variable $x : G(\alpha)$ as a map $t_0$ associating to each set $A$ a
homomorphism $t_0(A) : G_0(A) \to F_0(A)$, and to each relation $R$ a
morphism $t_1(R) : G_1(R) \to F_1(R)$.  These interpretations are to
be given inductively on the structures of $F$ and $t$ in such a way
that they imply two fundamental theorems. The first is an
\emph{Identity Extension Lemma}, which states that $F_1(\Eq_A) =
\Eq_{F_0(A)}$, and is the essential property that makes a model
relationally parametric rather than just induced by a logical
relation. The second is an \emph{Abstraction Theorem}, which states
that, for any $R :\rel(A, B)$, $(t_0(A),t_0(B))$ is a morphism in
$\rel$ from $(G_0(A),G_0(B),G_1(R))$ to $(F_0(A),F_0(B),F_1(R))$. The
Identity Extension Lemma is similar to the Abstraction Theorem except
that it holds for {\em all} elements of a type's interpretation, not
just those that are interpretations of terms.  Similar theorems are
expected to hold for types and terms with any number of free
variables.

To accommodate GADTs, we will need to transition Reynolds' approach
from a $\set$-based semantics to a semantics based on
$\omega$-complete partial orders. We denote the category of
$\omega$-complete partial orders ($\oCPO$s) and their sup-preserving
morphisms by $\omega$CPO. The underlying set of an $\oCPO$ $A$ is
denoted $|A|$.  The category $\oCPOR$ of relations on $\omega$CPOs has
as its objects triples $(A,B,R)$, where $A, B: \oCPO$ and $R:
\rel(|A|, |B|)$ and $(\bigvee_{i < \omega} a_i, \bigvee_{i < \omega}
b_i) \in R$ whenever $(a_i)_{i < \omega}$ and $(b_i)_{i < \omega}$ are
chains in $A$ and $B$, respectively, such that $(a_i,b_i) \in R$ for
all $i$. The category $\oCPOR$ has as its morphisms from $(A,B,R)$ to
$(A',B',R')$ pairs $(f : A \to A',g : B \to B')$ of morphisms in
$\oCPO$ such that $(f\,a, g\,b) \in R'$ whenever $(a,b) \in R$. We
note that if $(f,g) : (A,B,R) \to (A',B',R')$ and $(a_i)_{i < \omega}$
and $(b_i)_{i < \omega}$ are chains in $A$ and $B$, respectively, then
$ (f \, (\bigvee_{i < \omega} a_i), g \, (\bigvee_{i < \omega} b_i)) =
(\bigvee_{i < \omega} (f a_i), \bigvee_{i < \omega} (g b_i)) \in R'$
necessarily holds.  We write $R : \oCPOR(A,B)$ in place of $(A,B,R):
\oCPOR$ when convenient. If $R : \oCPOR(A,B)$ then we write $\pi_1 R$
and $\pi_2 R$ for the {\em domain} $A$ of $R$ and the {\em codomain}
$B$ of $R$, respectively. If $A : \oCPO$, then we write $\Eq_A =
(A,A,\Eq_{|A|})$ for the {\em equality relation} on $A$.

To adapt Reynolds' approach, we first inductively define, for each
type, an object interpretation in $\oCPO$ and a relational
interpretation in $\oCPOR$.  Next, we show that these interpretations
satisfy both an Identity Extension Lemma (Theorem~\ref{thm:iel}) and
an Abstraction Theorem (Theorem~\ref{thm:gen-at}) appropriate to the
$\oCPO$ setting. The key to proving our Identity Extension Lemma is a
familiar ``cutting down'' of the interpretations of universally
quantified types to include only the ``parametric'' elements; as
in~\cite{jgj20}, the relevant types of the calculus defined above are
the (now richer) $\Nat$-types.  The requisite cutting down requires
that the object interpretations of our types in $\omega$CPO are
defined simultaneously with their relational interpretations in
$\oCPOR$.  We give the object interpretations for our types in
Section~\ref{sec:obj-interp} and give their relational interpretations
in Section~\ref{sec:rel-interp}.  While the former are relatively
straightforward, the latter are less so, mainly because of the
cocontinuity conditions, adapted from the $\set$-based setting
of~\cite{jgj20}, that must hold if they are to be well-defined. We
develop these conditions in Section~\ref{sec:rel-interp}, which
separates Definitions~\ref{def:set-sem} and~\ref{def:rel-sem} in
space, but otherwise has no impact on the fact that they are given by
mutual induction.

\subsection{Object Interpretations of Types}\label{sec:obj-interp}

The object interpretations of the types in our calculus will be
$\omega_1$-cocontinuous functors between categories of
$\omega_1$-cocontinuous functors on categories constructed from the
locally $\omega_1$-presentable category $\oCPO$.  We therefore begin
by recording some important facts about locally $\omega_1$-presentable
categories and functors on them, and verifying verify the properties
needed to interpret our syntax.

\subsubsection{Preliminaries}

\new{Perhaps have as preliminaries to entire paper. Do everything for
  $\lambda CPOs$? Define these; investigate their properties.}

A category is \emph{small} if its collection of morphisms is a set.
It is \emph{locally small} if, for any two objects $A$ and $B$, the
collection of morphisms from $A$ to $B$ is a set. A {\em small
  (co)limit} in a category $\mcC$ is a (co)limit of a diagram $F :
\mcA \to \mcC$, where $\mcA$ is a small category. A category $\mcC$
is {\em (co)complete} if it has all small (co)limits.

A poset $\mcD = (D,\leq)$ is \emph{$\omega_1$-directed} if every
countable subset of $D$ has a supremum. When $\mcD$ is considered
as a category, we write $d \in \mcD$ to indicate that $d$ is an object
of $\mcD$ (i.e., $d \in D$). An {\em $\omega_1$-directed colimit} in a
category $\mcC$ is a colimit of a diagram $F : {\mathcal D} \to \mcC$,
where $\mathcal D$ is an $\omega_1$-directed poset. A category $\mcC$
is {\em $\omega_1$-cocomplete} if it has all $\omega_1$-directed
colimits; a {\em cocomplete} category is one that has all colimits.

If $\mcA$ and $\mcC$ are $\omega_1$-cocomplete, then the functor $F :
\mcA \to \mcC$ is {\em $\omega_1$-cocontinuous} if it preserves
$\omega_1$-directed colimits. We write $[\A,\C]_{\omega_1}$ for 
the category of $\omega_1$-cocontinuous functors from $\A$ to $\C$,
and $\C^\A$ for the category of {\em all} functors from $\A$ to $\C$.
Since (co)limits of functors are computed pointwise, $C^\A$ has all
(co)limits that $\C$ has, and (co)limits of (co)continuous functors
are again (co)continuous. It follows that $[\A,\C]_{\omega_1}$ is
($\omega_1$1)(co)complete whenever $\C$ is.

If $\mcA$ is locally small, then an object $A$ of $\mcA$ is {\em
  $\omega_1$-presentable} if the functor $\mathsf{Hom}_\mcA(A, -) :
\mcA \to \Set$ preserves $\omega_1$-directed colimits, i.e., if for
every $\omega_1$-directed poset $\mathcal D$ and every functor $F :
{\mathcal D} \to \mcC$, there is a canonical isomorphism $\colim{d \in
  \mcD}{\mathsf{Hom}_\mcA(A,Fd)} \simeq \mathsf{Hom}_{\mcA}(A,
\colim{d \in \mcD}{Fd})$. A locally small category $\mcA$ is {\em
  $\omega_1$-accessible} if it is $\omega_1$-cocomplete and has a set
$\mcA_0$ of $\omega_1$-presentable objects such that every object is
an $\omega_1$-directed colimit of objects in $\mcA_0$; a locally small
category is {\em locally $\omega_1$-presentable} if it is
$\omega_1$-accessible and cocomplete.

The category $\oCPO$ is locally $\omega_1$-presentable (but not
locally finitely presentable); see Examples~1.18(2)
of~\cite{ar94}). Its $\omega_1$-presentable objects are precisely the
$\omega$CPOs cardinality less than $\omega_1$, i.e., the countable
$\omega$CPOs. In the next subsection we will interpret type variables
in $\tvars^k \cup \fvars^k$ as elements of
$[\oCPO^k,\oCPO]_{\omega_1}$; the following special cases of standard
results (see, e.g.,~\cite{ar94}) will therefore be critical to
deducing important properties of our object interpretations of types:
\begin{prop}\label{prop:prelims}
\begin{enumerate}
\item If $\C_1,...,\C_n$ are locally $\omega_1$-presentable categories
  then so is $\C_1 \times ... \times \C_n$. Moreover, the presentable
  objects of $\C_1 \times ... \times \C_n$ are exactly the tuples of
  the form $(P_1,...,P_n)$, where, for each $i = 1,...,n$, the object
  $P_i$ is presentable in $\C_i$.
\item If $\mathcal{A}$ is $\omega_1$-accessible and $\mathcal{C}$ is
  $\lambda$-cocomplete, then the category $[\mathcal{A},
  \mathcal{C}]_{\omega_1}$ is naturally equivalent to the category
  $\mathcal{C}^{\mathcal{A}_0}$.
\item If $\mathcal{C}$ is locally $\omega_1$-presentable and
  $\mathcal{A}_0$ is essentially small, then
  $\mathcal{C}^{\mathcal{A}_0}$ is locally $\omega_1$-presentable.
\end{enumerate}
\end{prop}
\noindent
Together, the statements in Proposition~\ref{prop:prelims} give that
if $\mathcal{A}$ and $\mathcal{C}$ are locally $\omega_1$-presentable,
then $[\mathcal{A}, \mathcal{C}]_{\omega_1}$ is naturally equivalent
to $\mathcal{C}^{\mathcal{A}_0}$, and thus is
$\omega_1$-presentable. Thus, for all $k_1,...,k_n \in \nat^n$,
$[\mathcal{A}, \mathcal{C}]_{\omega_1}^{k_1} \times ... \times
[\mathcal{A}, \mathcal{C}]_{\omega_1}^{k_n}$ is locally
$\omega_1$-presentable, and therefore $[[\mathcal{A},
    \mathcal{C}]_{\omega_1}^{k_1} \times ... \times [\mathcal{A},
    \mathcal{C}]_{\omega_1}^{k_n}, \mathcal{C}]_{\omega_1}$ is as
well. Taking both $\A$ and $C$ to be $\oCPO$ --- as we will to ensure
that the fixpoints interpreting $\mu$-types in $\oCPO$ exist --- we
have
\begin{prop}\label{prop:nat-interps-sets}
  For all $k_1,...,k_n \in \nat^n$,
  \[[[\oCPO, \oCPO]_{\omega_1}^{k_1}
  \times ... \times [\oCPO, \oCPO]_{\omega_1}^{k_n},
  \oCPO]_{\omega_1}\] is locally $\omega_1$-presentable.
\end{prop}

\subsubsection{Object Interpretations}

To define the object interpretations of the types in
Definition~\ref{def:wftypes} we must first interpret their
variables. We have:

\begin{dfn}\label{def:set-env}
A {\em $\oCPO$ environment} maps each type variable in $\tvars^k \cup
\fvars^k$ to an element of $[\oCPO^k,\oCPO]_{\omega_1}$.  A morphism
$f : \rho \to \rho'$ for set environments $\rho$ and $\rho'$ with
$\rho|_\tvars = \rho'|_\tvars$ maps each type constructor variable
$\psi^k \in \tvars$ to the identity natural transformation on $\rho
\psi^k = \rho'\psi^k$ and each functorial variable $\phi^k \in \fvars$
to a natural transformation from the $k$-ary functor $\rho \phi^k$ on
$\oCPO$ to the $k$-ary functor $\rho' \phi^k$ on $\oCPO$.  Composition
of morphisms on set environments is given componentwise, with the
identity morphism mapping each set environment to itself. This gives a
category of set environments and morphisms between them, which we
denote $\oCPOenv$.
\end{dfn}

When convenient we identify a functor in $[\oCPO^0, \oCPO]_{\omega_1}$
with its value on $\ast$ and consider a $\oCPO$ environment to map a
type variable of arity $0$ to an $\omega_1$-cocontinuous functor from
$\oCPO^0$ to $\oCPO$, i.e., to an $\oCPO$. If $\Phi =
\{\phi_1^{k_1},...,\phi_n^{k_n}\}$ and $\ol K = \{K_1,...,K_n\}$ where
$K_i : [\oCPO^{k_i},\oCPO]_{\omega_1}$ for $i = 1,...,n$, then we
write $\rho[\ol{\Phi := K}]$ for the $\oCPO$ environment $\rho'$ such
that $\rho' \phi_i = K_i$ for $i = 1,...,n$ and $\rho' \phi = \rho
\phi$ if $\phi \not \in \Phi$.  If $\rho$ is an $\oCPO$ environment,
we write $\Eq_\rho$ for the $\oCPOR$ environment (see
Definition~\ref{def:reln-env}) such that $\Eq_\rho v = \Eq_{\rho v}$
for every type variable $v$. The categories $\oCPORT_k$ and relational
interpretations appearing in the third clause of
Definition~\ref{def:set-sem} are given in full in
Section~\ref{sec:rel-interp}. We note that $\omega_1$-directed
colimits in $\oCPOenv$ are taken pointwise.

\begin{dfn}\label{def:set-sem}
The {\em object interpretation} $\oCPOsem{\cdot} : \F \to [\oCPOenv,
  \oCPO]_{\omega_1}$ is defined by
\begin{align*}
  \oCPOsem{\Gamma;\Phi \vdash \zerot}\rho &= 0\\
  \oCPOsem{\Gamma;\Phi \vdash \onet}\rho &= 1\\
  \oCPOsem{\Gamma; \emptyset
    \vdash \Nat^\Phi
    \,F\,G}\rho &= \{\eta : \lambda \ol{K}. \,\oCPOsem{\Gamma;
    \Phi \vdash
    F}\rho[\ol{\Phi := K}] 
      \Rightarrow \lambda \ol{K}.\,\oCPOsem{\Gamma; 
        \Phi \vdash G}\rho[\ol{\Phi := K}] \\ 
      &\hspace{0.3in}|~\forall \ol{K = (K_0, K_1, K^*) : \oCPORT_k}.\\
      &\hspace{0.4in}(\eta_{\overline{K_0}}, \eta_{\overline{K_1}})
      : \oCPORsem{\Gamma; \Phi \vdash F}\Eq_{\rho}[\ol{\Phi := K}]
      \rightarrow \oCPORsem{\Gamma; \Phi \vdash
        G}\Eq_{\rho}[\ol{\Phi := K}] \} \\
  \oCPOsem{\Gamma;\Phi \vdash \phi\ol{F}}\rho &=
  (\rho\phi)\,\ol{\oCPOsem{\Gamma;\Phi \vdash
    F}\rho}\\
  \oCPOsem{\Gamma;\Phi \vdash F+G}\rho &=
  \oCPOsem{\Gamma;\Phi \vdash F}\rho +
  \oCPOsem{\Gamma;\Phi \vdash G}\rho\\
  \oCPOsem{\Gamma;\Phi \vdash F \times G}\rho &=
  \oCPOsem{\Gamma;\Phi \vdash F}\rho \times
  \oCPOsem{\Gamma;\Phi \vdash G}\rho\\ 
  \oCPOsem{\Gamma;\Phi,\ol\gamma \vdash (\mu \phi.\lambda
    \ol{\alpha}. H)\ol{G}}\rho &= (\mu
    T^\oCPO_{H,\rho})\ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash G}\rho}\\
    \text{where } T^\oCPO_{H,\rho}\,F & = \lambda
  \ol{A}. \oCPOsem{\Gamma;\ol\gamma,\phi, \ol{\alpha} \vdash
    H}\rho[\phi :=  F][\ol{\alpha := A}]\\
  \text{and } T^\oCPO_{H,\rho}\,\eta &= \lambda
  \ol{A}. \oCPOsem{\Gamma;\ol\gamma,\phi, \ol{\alpha} \vdash
    H}\id_\rho[\phi := \eta][\ol{\alpha := \id_{A}}] \\
  \oCPOsem{\Gamma;\Phi \vdash (\Lan^{\ol{\alpha}}_{\ol{K}} F)\ol{A}}\rho &=
    (\textit{Lan}_{\ol{\oCPOsem{\Gamma; \ol\alpha \vdash K}\rho[\ol{\alpha := \_}]}}
      \oCPOsem{\Gamma; \Phi, \ol\alpha \vdash F}\rho[\ol{\alpha := \_}])
    \ol{\oCPOsem{\Gamma; \Phi \vdash A}\rho}
\end{align*}
\end{dfn}
If $\rho \in \oCPOenv$ and $\vdash F$ then we write $\oCPOsem{\vdash F}$
instead of $\oCPOsem{\vdash F}\rho$ since the environment is
immaterial.

For Definition~\ref{def:set-sem} to be well-defined, we have to check
that each object interpretation is in $\oCPO$ and, in particular, that
each contains sups of all $\omega$-chains. This will be proved by
induction on types, and in most cases existence of sups of
$\omega$-chains will follow from the induction hypotheses. However,
well-definedness needs to be proved directly for object
interpretations of $\Nat$-types. First, we have
\begin{lemma}\label{lem:nat-types-sets}
The collection of all natural transformations 
\[
\eta : \lambda \ol K. \setsem{\Gamma;\Phi \vdash F}\rho[\ol{\Phi := K}]
\Rightarrow \lambda \ol K. \setsem{\Gamma;\Phi \vdash G}\rho[\ol{\Phi :=
  K}]
\]
defines a set.
\end{lemma}
\begin{proof}
We first note that $\lambda \ol K. \setsem{\Gamma;\Phi \vdash
  F}\rho[\ol{\Phi := K}]$ and $\lambda \ol K. \setsem{\Gamma;\Phi
  \vdash G}\rho[\ol{\Phi := K}]$ are both in $[\ol{[\oCPO^k ,
      \oCPO]_{\omega_1}}, \oCPO]_{\omega_1}$. By
Proposition~\ref{prop:nat-interps-sets}, $[\ol{[\oCPO^k ,
      \oCPO]_{\omega_1}}, \oCPO]_{\omega_1}$ is locally
$\omega_1$-presentable. It is therefore locally small, so there are
only $\set$-many morphisms (i.e., natural transformations) between any
two functors in $[\ol{[\oCPO^k , \oCPO]_{\omega_1}},
  \oCPO]_{\omega_1}$. In particular, there are only $\set$-many
natural transformations from $\lambda \ol K. \setsem{\Gamma;\Phi
  \vdash F}\rho[\ol{\Phi := K}]$ to $\lambda \ol
K. \setsem{\Gamma;\Phi \vdash G}\rho[\ol{\Phi := K}]$.
\end{proof}

\new{Need to modify to take equality conditions into account.}  Now,
if $\C$ is any category, then given functors $F,G : \C \to \oCPO$ and
natural transformations $\eta, \eta' : F \to G$, we define $\eta \leq
\eta'$ iff $\eta_c \leq \eta'_c$ for all $c \in \C$, i.e., iff
$\eta_c\,x \leq \eta'_c\,x$ in $Gc$ for all $c \in \C$ and $x \in Fc$.
If $(\eta_i)_{i < \omega}$ is a chain in $\{\eta : F \to G\}$, then
the family of morphisms $(\bigvee_{i < \omega} \eta_i)_c = \lambda
x. \bigvee_{i < \omega} ((\eta_i)_c\,x) : Fc \to Gc$ defines a natural
transformation $\bigvee_{i < \omega} \eta_i : F \to G$, and this
natural transformation is clearly the supremum of $(\eta_i)_{i <
  \omega}$ in $\{\eta : F \to G\}$. We therefore have that $\{\eta : F
\to G\}$ is itself an $\oCPO$.  Letting $F = \lambda \ol
K. \setsem{\Gamma;\Phi \vdash F}\rho[\ol{\Phi := K}]$ and $G = \lambda
\ol K. \setsem{\Gamma;\Phi \vdash G}\rho[\ol{\Phi := K}]$, we have
that $\oCPOsem{\Gamma; \emptyset \vdash \Nat^\Phi F\,G}\rho$ is indeed
an $\oCPO$.

That each of the above interpretations is $\omega_1$-cocontinuous
follows from Corollary~12 of~\cite{jp19} if we \new{APPROPRIATELY
  RESTRICT THE SUBSCRIPTS OF $\Lan$s}.  For $\Nat$-types, we note that
$\oCPOsem{\Gamma; \emptyset \vdash \Nat^\Phi F\,G}$ is an
$\omega_1$-cocontinuous functor because, in accordance with
Definition~\ref{def:set-sem-funcs}, it is constant on
$\omega_1$-directed sets. Interpretations of $\Nat$-types ensure that
$\oCPOsem{\Gamma \vdash F \to G}$ and $\oCPOsem{\Gamma \vdash \forall
  \ol\alpha. F}$ are as expected in any parametric model.

To make sense of the next-to-last clause in
Definition~\ref{def:set-sem}, we need to know that, for each $\rho \in
\oCPOenv$, $T^\oCPO_{H,\rho}$ is an $\omega_1$-cocontinuous
endofunctor on $[\oCPO^k, \oCPO]_{\omega_1}$, and thus admits a
fixpoint.  Since $T_{H,\rho}^\oCPO$ is defined in terms of
$\oCPOsem{\Gamma;\ol\gamma,\phi, \ol{\alpha} \vdash H}$, this means
that interpretations of types must be such functors, which in turn
means that the actions of set interpretations of types on objects and
on morphisms in $\oCPOenv$ are intertwined. Fortunately, we know
from~\cite{jp19} that, for every $\Gamma; \ol\alpha \vdash F$,
$\oCPOsem{\Gamma; \Phi \vdash F}$ is actually in
$[\oCPO^k,\oCPO]_{\omega_1}$, where $k = |\ol\alpha|$.  Therefore, for
each $\oCPOsem{\Gamma; \ol\gamma, \phi^k, \ol{\alpha} \vdash H}$, the
corresponding operator $T^\oCPO_{H}$ can be extended to a {\em
  functor} from $\oCPOenv$ to
$[[\oCPO^k,\oCPO]_{\omega_1},[\oCPO^k,\oCPO]_{\omega_1}]_{\omega_1}$.
The action of $T^\oCPO_H$ on an object $\rho \in \oCPOenv$ is given by
the higher-order functor $T_{H,\rho}^\oCPO$, whose actions on objects
(functors in $[\oCPO^k, \oCPO]_{\omega_1}$) and on morphisms (natural
transformations between such functors) are given in
Definition~\ref{def:set-sem}. The action of $T^\oCPO_H$ on a morphism
$f : \rho \to \rho'$ is the higher-order natural transformation
$T^\oCPO_{H,f} : T^\oCPO_{H,\rho} \to T^\oCPO_{H,\rho'}$ whose action
on $F : [\oCPO^k,\oCPO]_{\omega_1}$ is the natural transformation
$T^\oCPO_{H,f}\, F : T^\oCPO_{H,\rho}\,F \to T^\oCPO_{H,\rho'}\,F$
whose component at $\ol A$ is $(T^\oCPO_{H,f}\, F)_{\ol A} =
\oCPOsem{\Gamma; \ol\gamma,\phi,\ol{\alpha} \vdash H}f[\phi :=
  \id_F][\ol{\alpha := \id_A}]$.

%For the last clause in Definition~\ref{def:set-sem} to be well-defined
%we need $\oCPOsem{\Gamma; \ol\alpha \vdash K}\rho[\ol{\alpha := \_}]$
%and $\oCPOsem{\Gamma; \Phi, \ol\alpha \vdash F}\rho[\ol{\alpha :=
%    \_}]$ to be $\omega_1$-cocontinuous functors.
In addition, for each $\ol K$, we have that $\textit{Lan}_{\ol K}$ is
itself a (higher-order) functor. Specifically, given functors $F, F' :
\C \to \D$, a sequence of functors $\ol K = K_1, ..., K_n$ with $K_i :
\C \to \C_i$ for $i = 1,...,n$, and a natural transformation $\alpha :
F \to G$, the functorial action $\textit{Lan}_{\ol K} \alpha :
\textit{Lan}_{\ol K} F \to \textit{Lan}_{\ol K} F'$ of
$\mathit{Lan}_{\ol K}$ on $\alpha$ is defined to be the unique natural
transformation such that $((\textit{Lan}_{\ol K} \alpha) \,\circ
\,\langle K_1,...,K_n \rangle) \circ \eta_F = \eta_{F'} \,\circ\,
\alpha$. Here, $\eta_F : F \to (\textit{Lan}_{\ol K} F) \circ \langle
K_1,...,K_n \rangle$ and $\eta_{F'} : F' \to (\textit{Lan}_{\ol K} F')
\circ \langle K_1,...,K_n \rangle$ are the natural transformations
associated with the functors $\textit{Lan}_{\ol K} F$ and
$\textit{Lan}_{\ol K} F'$ from $\Pi_{i \in \{1,...,n\}} \C_i$ to $\D$,
respectively. It is not hard to see that $\mathit{Lan}_{\ol K}$ is a
(higher-order) functor under this definition.

The next definition uses the functors $T^\oCPO_H$ and $\mathit{Lan}_K$
to define the actions of functors interpreting types on morphisms
between set environments.

\begin{dfn}\label{def:set-sem-funcs}
Let $f: \rho \to \rho'$ be a morphism between $\oCPO$ environments $\rho$
and $\rho'$ (so that $\rho|_\tvars = \rho'|_\tvars$). The action
$\oCPOsem{\Gamma;\Phi \vdash F}f$ of\, $\oCPOsem{\Gamma;\Phi \vdash F}$
on the morphism $f$ is given as follows:
\begin{itemize}
\item If \,$\Gamma;\Phi \vdash \zerot$ then $\oCPOsem{\Gamma;\Phi \vdash
  \zerot}f = \id_0$
\item If \,$\Gamma;\Phi \vdash \onet$ then $\oCPOsem{\Gamma;\Phi \vdash
  \onet}f = \id_1$
\item If \,$\Gamma; \emptyset
  \vdash \Nat^\Phi F\,G$ then
  $\oCPOsem{\Gamma; \emptyset
    \vdash \Nat^\Phi F\,G} f =
  \id_{\oCPOsem{\Gamma; \emptyset
      \vdash \Nat^\Phi F\,G}\rho}$
\item If \,$\Gamma;\Phi \vdash \phi \ol{F}$ then
 \begin{multline*}
 \oCPOsem{\Gamma;\Phi \vdash \phi \ol{F}} f : \oCPOsem{\Gamma;\Phi
  \vdash \phi \ol{F}}\rho \to \oCPOsem{\Gamma;\Phi \vdash
  \phi\ol{F}}\rho' \\
  = (\rho\phi) \ol{\oCPOsem{\Gamma;\Phi \vdash
  F}\rho} \to (\rho'\phi) \ol{\oCPOsem{\Gamma;\Phi \vdash
  F}\rho'}
 \end{multline*}
  is defined by
  \[
  \begin{split}
  \oCPOsem{\Gamma;\Phi \vdash \phi \ol{F}} f
  &= (f\phi)_{\ol{\oCPOsem{\Gamma;\Phi \vdash
      F}\rho'}}\, \circ\, (\rho\phi) {\ol{\oCPOsem{\Gamma;\Phi
      \vdash F}f}} \\
  &= (\rho'\phi) {\ol{\oCPOsem{\Gamma;\Phi \vdash
      F}f}}\, \circ\, (f \phi)_{\ol{\oCPOsem{\Gamma;\Phi \vdash
      F}\rho}}
  \end{split}
  \]
  The latter equality holds because $\rho\phi$ and
  $\rho'\phi$ are functors and $f\phi : \rho\phi \to \rho'\phi$ is a
  natural transformation, so the following naturality square commutes:
{\footnotesize\begin{equation}\label{eq:cd2}
\begin{CD}
  (\rho\phi) \ol{\oCPOsem{\Gamma;\Phi \vdash F}\rho} @> (f\phi)_{
    \ol{\oCPOsem{\Gamma;\Phi \vdash F}\rho}} >> (\rho'\phi)
  \ol{\oCPOsem{\Gamma;\Phi \vdash F}\rho} \\ @V(\rho\phi)
  \ol{\oCPOsem{\Gamma;\Phi \vdash F}f}VV @V (\rho'\phi)
  \ol{\oCPOsem{\Gamma;\Phi \vdash F}f} VV \\ (\rho\phi)
  \ol{\oCPOsem{\Gamma;\Phi \vdash F}\rho'} @>(f\phi)_{
    \ol{\oCPOsem{\Gamma;\Phi \vdash F}\rho'}}>> (\rho'\phi)
  \ol{\oCPOsem{\Gamma;\Phi \vdash F}\rho'}
\end{CD}
\end{equation}}
\item If\, $\Gamma;\Phi \vdash F + G$ then $\oCPOsem{\Gamma;\Phi
  \vdash F + G}f$ is defined by
  \begin{align*}
  \oCPOsem{\Gamma;\Phi \vdash F + G}f(\inl\,x) 
  &= \inl\,(\oCPOsem{\Gamma;\Phi \vdash
  F}f x) \\
  \oCPOsem{\Gamma;\Phi \vdash F + G}f(\inr\,y)
  &= \inr\,(\oCPOsem{\Gamma;\Phi \vdash G}f y)
  \end{align*}
\item If \,$\Gamma;\Phi\vdash F \times G$ then
  $\oCPOsem{\Gamma;\Phi \vdash F \times G}f = 
  \oCPOsem{\Gamma;\Phi \vdash F}f \times \oCPOsem{\Gamma;\Phi \vdash
    G}f$
\item If \,$\Gamma;\Phi,\ol\gamma \vdash (\mu \phi.\lambda
  \ol{\alpha}. H)\ol{G}$ then
  \[\begin{array}{lll}
  \oCPOsem{\Gamma;\Phi,\ol\gamma \vdash (\mu  \phi.\lambda
    \ol{\alpha}. H)\ol{G}} f &: &\oCPOsem{\Gamma;\Phi,\ol\gamma 
    \vdash (\mu \phi.\lambda \ol{\alpha}. H)\ol{G}} \rho \to
  \oCPOsem{\Gamma;\Phi,\ol\gamma \vdash (\mu
    \phi.\lambda\ol{\alpha}. H)\ol{G}} \rho'\\
  &= &(\mu
  T^\oCPO_{H,\rho})\ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash G}\rho} \to (\mu
  T^\oCPO_{H,\rho'})\ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash G}\rho'}
  \end{array}\]
  is
  defined by
  \[\begin{array}{ll}
  & (\mu T^\oCPO_{H,f})_{\ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash
      G}\rho'}} \circ (\mu T^\oCPO_{H,\rho})\ol{\oCPOsem{\Gamma;\Phi,\ol\gamma
      \vdash G}f}\\[2ex] = & (\mu
  T^\oCPO_{H,\rho'})\ol{\oCPOsem{\Gamma;\Phi,\ol\gamma 
      \vdash G}f} \circ (\mu T^\oCPO_{H,f})_{\ol{\oCPOsem{\Gamma;\Phi,\ol\gamma
      \vdash G}\rho}}\end{array}\]  The latter equality holds because $\mu
  T^\oCPO_{H,\rho}$ and $\mu T^\oCPO_{H,\rho'}$ are functors and $\mu
  T_{H,f}^\oCPO : \mu T_{H,\rho}^\oCPO \to \mu T_{H,\rho'}^\oCPO$ is a
  natural transformation, so the following naturality square commutes:
{\footnotesize\begin{equation}\label{eq:cd3}
\begin{CD}
 (\mu T^\oCPO_{H,\rho}) \ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash G}\rho} @> (\mu
  T^\oCPO_{H,f})_{\ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash G}\rho}} >> (\mu
  T^\oCPO_{H,\rho'}) \ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash G}\rho} \\ 
 @V(\mu T^\oCPO_{H,\rho}) \ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash G}f}VV @V  (\mu
 T^\oCPO_{H,\rho'}) \ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash G}f} VV \\ 
(\mu T^\oCPO_{H,\rho}) \ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash G}\rho'} @>(\mu
 T^\oCPO_{H,f})_{\ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash G}\rho'}}>> (\mu
 T^\oCPO_{H,\rho'}) \ol{\oCPOsem{\Gamma;\Phi,\ol\gamma \vdash G}\rho'}
\end{CD}
\end{equation}}
\item If\, $\Gamma;\Phi \vdash (\Lan^{\ol{\alpha}}_{\ol{K}} F)\ol{A}$ then
  \[\oCPOsem{\Gamma;\Phi \vdash (\Lan^{\ol{\alpha}}_{\ol{K}} F)\ol{A}}f
: \oCPOsem{\Gamma;\Phi \vdash (\Lan^{\ol{\alpha}}_{\ol{K}}
    F)\ol{A}}\rho \to \oCPOsem{\Gamma;\Phi \vdash
    (\Lan^{\ol{\alpha}}_{\ol{K}} F)\ol{A}}\rho'\] is defined by
\[\begin{array}{ll}
 & \big(\textit{Lan}_{\ol{\oCPOsem{\Gamma; \ol\alpha \vdash K}\rho[\ol{\alpha := \_}]}}\,
      \oCPOsem{\Gamma; \Phi, \ol\alpha \vdash F}f[\ol{\alpha := \id_{\_}}]\big)
    \ol{\oCPOsem{\Gamma; \Phi \vdash A}\rho'} \\
 &  \circ\;
  \big(\textit{Lan}_{\ol{\oCPOsem{\Gamma; \ol\alpha \vdash K}\rho[\ol{\alpha := \_}]}}\,
      \oCPOsem{\Gamma; \Phi, \ol\alpha \vdash F}\rho[\ol{\alpha := \_}]\big)
    \ol{\oCPOsem{\Gamma; \Phi \vdash A}f} \\
= & \big(\textit{Lan}_{\ol{\oCPOsem{\Gamma; \ol\alpha \vdash K}\rho[\ol{\alpha := \_}]}}\,
      \oCPOsem{\Gamma; \Phi, \ol\alpha \vdash F}\rho'[\ol{\alpha := \_}]\big)
    \ol{\oCPOsem{\Gamma; \Phi \vdash A}f} \\
 &  \circ\;
  \big(\textit{Lan}_{\ol{\oCPOsem{\Gamma; \ol\alpha \vdash K}\rho[\ol{\alpha := \_}]}}\,
      \oCPOsem{\Gamma; \Phi, \ol\alpha \vdash F}f[\ol{\alpha := \id_{\_}}]\big)
    \ol{\oCPOsem{\Gamma; \Phi \vdash A}\rho}
\end{array}\]
where the above equality holds by naturality of
$\textit{Lan}_{\ol{\oCPOsem{\Gamma; \ol\alpha \vdash
        K}\rho[\ol{\alpha := \_}]}}\,\oCPOsem{\Gamma; \Phi, \ol\alpha
    \vdash F}f[\ol{\alpha := \id_{\_}}]$.
%(and functoriality of
%  $\textit{Lan}_{\ol{\oCPOsem{\Gamma; \ol\alpha \vdash
%        K}\rho[\ol{\alpha := \_}]}}$,
%  $\textit{Lan}_{\ol{\oCPOsem{\Gamma; \ol\alpha \vdash
%        K}\rho'[\ol{\alpha := \_}]}}$, and $\ol{\oCPOsem{\Gamma; \Phi
%      \vdash A}}$).
\end{itemize}
\end{dfn}

Definitions~\ref{def:set-sem} and~\ref{def:set-sem-funcs} respect
weakening, i.e., ensure that a type and its weakenings have the same
set interpretations.

\subsection{Relational Interpretations of Types}\label{sec:rel-interp}

\begin{dfn}\label{def:rel-transf}
A {\em $k$-ary $\oCPO$ relation transformer} $F$ is a triple $(F^1,
F^2,F^*)$, where $F^1,F^2 : [\oCPO^k,\oCPO]_{\omega_1}$ and $F^* :
[\oCPOR^k, \oCPOR]_{\omega_1}$ are such that if
$R_1:\oCPOR(A_1,B_1),...,R_k:\oCPOR(A_k,B_k)$ then $F^* \ol{R} :
\oCPOR(F^1 \ol{A}, F^2 \ol{B})$, and if $(\alpha_1, \beta_1) \in
\HomoCPOR(R_1,S_1),..., (\alpha_k, \beta_k) \in \HomoCPOR(R_k,S_k)$
then $F^* \ol{(\alpha, \beta)} = (F^1 \ol{\alpha}, F^2 \ol{\beta})$.
We define $F\ol{R}$ to be $F^*\overline{R}$ and
$F\overline{(\alpha,\beta)}$ to be $F^*\overline{(\alpha,\beta)}$.
\end{dfn}
The first condition of the first sentence of
Definition~\ref{def:rel-transf} entails that $F^*\ol R$ relates sups
of chains of pairwise related elements in $F^1 \ol A$ and $F^2 \ol
B$. The last condition of the first sentence of
Definition~\ref{def:rel-transf} expands to: if $\ol{(a,b) \in R}$
implies $\ol{(\alpha\,a,\beta\,b) \in S}$ then $(c,d) \in F^*\ol{R}$
implies $(F^1 \ol{\alpha}\,c,F^2 \ol{\beta}\,d) \in F^*\ol{S}$. When
convenient we identify a $0$-ary $\oCPO$ relation transformer
$(A,B,R)$ with $R : \oCPOR(A,B)$. We may also write $\pi_1 F$ for
$F^1$ and $\pi_2 F$ for $F^2$. We extend these conventions to $\oCPO$
relation environments, introduced in Definition~\ref{def:reln-env}
below, in the obvious way.

\begin{dfn}
The category $\oCPORT_k$ of $k$-ary $\oCPO$ relation transformers is
given by the following data:
\begin{itemize}
\item An object of $\oCPORT_k$ is a $k$-ary $\oCPO$ relation transformer.
\item A morphism $\delta : (G^1,G^2,G^*) \to (H^1,H^2,H^*)$ in
  $\oCPORT_k$ is a pair of natural transformations $(\delta^1,
  \delta^2)$, where $\delta^1 : G^1 \to H^1$ and $\delta^2 : G^2 \to
  H^2$ are such that, for all $\ol{R : \oCPOR(A, B)}$, if $(x, y) \in
  G^*\ol{R}$ then $(\delta^1_{\ol{A}}x, \delta^2_{\ol{B}}y) \in
  H^*\ol{R}$.
\item Identity morphisms and composition are inherited from the
  category of functors on $\oCPO$.
\end{itemize}
\end{dfn}

\begin{dfn}\label{def:RT-functor}
An endofunctor $H$ on $\oCPORT_k$ is a triple $H = (H^1,H^2,H^*)$, where
\begin{itemize}
\item $H^1$ and $H^2$ are functors from $[\oCPO^k,\oCPO]_{\omega_1}$ to $[\oCPO^k,\oCPO]_{\omega_1}$
\item $H^*$ is a functor from $\oCPORT_k$ to $[\oCPOR^k,\oCPOR]_{\omega_1}$
\item for all $\overline{R : \oCPOR(A,B)}$,
  $\pi_1((H^*(\delta^1,\delta^2))_{\overline{R}}) = (H^1
  \delta^1)_{\overline{A}}$ and
  $\pi_2((H^*(\delta^1,\delta^2))_{\overline{R}}) = (H^2
  \delta^2)_{\overline{B}}$
\item The action of $H$ on objects is given by $H\,(F^1,F^2,F^*) =
  (H^1F^1,\,H^2F^2,\,H^*(F^1,F^2,F^*))$
\item The action of $H$ on morphisms is given by
  $H\,(\delta^1,\delta^2) = (H^1\delta^1,H^2\delta^2)$ for
  $(\delta^1,\delta^2) : (F^1,F^2,F^*)\to (G^1,G^2,G^*)$
\end{itemize}
\end{dfn}
Since the results of applying an endofunctor $H$ to $k$-ary $\oCPO$
relation transformers and morphisms between them must again be $k$-ary
$\oCPO$ relation transformers and morphisms between them,
respectively, Definition~\ref{def:RT-functor} implicitly requires that
the following three conditions hold:\,{\em i}) if
$R_1:\oCPOR(A_1,B_1),...,R_k:\oCPOR(A_k,B_k)$, then $H^*(F^1,F^2,F^*)
\ol{R} : \oCPOR(H^1F^1 \ol{A}, H^2F^2 \ol{B})$; {\em ii}) if
$(\alpha_1, \beta_1) \in \HomoCPOR(R_1,S_1),..., (\alpha_k, \beta_k)
\in \HomoCPOR(R_k,S_k)$, then $H^*(F^1,F^2,F^*)\, \ol{(\alpha, \beta)}
= (H^1F^1\ol{\alpha}, H^2F^2 \ol{\beta})$; and {\em iii}) if
$(\delta^1,\delta^2) : (F^1,F^2,F^*)\to (G^1,G^2,G^*)$ and
$R_1:\oCPOR(A_1,B_1),...,R_k:\oCPOR(A_k,B_k)$, then
$((H^1\delta^1)_{\ol{A}}x, (H^2\delta^2)_{\ol{B}}y) \in
H^*(G^1,G^2,G^*)\ol{R}$ whenever $(x, y) \in
H^*(F^1,F^2,F^*)\ol{R}$. Note, however, that this last condition is
automatically satisfied because it is implied by the third bullet
point of Definition~\ref{def:RT-functor}.

\begin{dfn}\label{def:RT-nat-trans}
If $H$ and $K$ are endofunctors on $\oCPORT_k$, then a {\em natural
  transformation} $\sigma : H \to K$ is a pair $\sigma = (\sigma^1,
\sigma^2)$, where $\sigma^1 : H^1 \to K^1$ and $\sigma^2 : H^2 \to
K^2$ are natural transformations between endofunctors on
$[\oCPO^k,\oCPO]_{\omega_1}$ and the component of $\sigma$ at $F
%= (F^1,F^2,F^*)
\in \oCPORT_k$ is given by $\sigma_F = (\sigma^1_{F^1}, \sigma^2_{F^2})$.
\end{dfn}

Definition~\ref{def:RT-nat-trans} entails that $\sigma^i_{F^i}$ must
be natural in $F^i : [\oCPO^k,\oCPO]_{\omega_1}$, and, for every $F$,
$(\sigma^1_{F^1})_{\overline{A}}$ and
$(\sigma^2_{F^2})_{\overline{B}}$ must be natural in $\overline{A}$
and $\ol B$, respectively.  Moreover, since the results of applying
$\sigma$ to $k$-ary $\oCPO$ relation transformers must be morphisms of
$k$-ary relation transformers, Definition~\ref{def:RT-nat-trans}
implicitly requires that $(\sigma_F)_{\overline{R}} = (
(\sigma^1_{F^1})_{\overline{A}}, (\sigma^2_{F^2})_{\overline{B}})$ is
a morphism in $\oCPOR$ for any $k$-tuple of relations $\overline{R :
  \rel(A, B)}$, i.e., that if $(x, y) \in H^*F\overline{R}$, then
$((\sigma^1_{F^1})_{\overline{A}} x, (\sigma^2_{F^2})_{\overline{B}}
y) \in K^*F\overline{R}$.

Critically, we can compute $\omega_1$-directed colimits in
$\oCPORT_k$: it is not hard to see that if $\cal D$ is an
$\omega_1$-directed set then $\colim{d \in {\cal D}}{(F^1_d,
  F^2_d,F^*_d)} = (\colim{d \in {\cal D}}{F^1_d}, \colim{d \in {\cal
    D}}{F^2_d}, \colim{d \in {\cal D}}{F^*_d})$.  We define an
endofunctor $T = (T^1,T^2,T^*)$ on $\oCPORT_k$ to be {\em
  $\omega_1$-cocontinuous} if $T^1$ and $T^2$ are
$\omega_1$-cocontinuous endofunctors on $[\oCPO^k,\oCPO]_{\omega_1}$
and $T^*$ is an $\omega_1$-cocontinuous functor from $\oCPORT_k$ to
$[\oCPOR^k,\oCPOR]_{\omega_1}$, i.e., is in
$[\oCPORT_k,[\oCPOR^k,\oCPOR]_{\omega_1}]_{\omega_1}$.

Now, for any $k$, any $A : \oCPO$, and any $R : \oCPOR(A, B)$, let
$K^\oCPO_A$ be the constantly $A$-valued functor from $\oCPO^k$ to
$\oCPO$ and $K^\oCPOR_R$ be the constantly $R$-valued functor from
$\oCPOR^k$ to $\oCPOR$.  Also let $0$ denote either the initial object
of $\oCPO$ or the initial object of $\oCPOR$, as appropriate.
Observing that, for every $k$, $K^\oCPO_0$ is initial in
$[\oCPO^k,\oCPO]_{\omega_1}$, and $K^\oCPOR_0$ is initial in
$[\oCPOR^k,\oCPOR]_{\omega_1}$, we have that, for each $k$, $K_0 =
(K^\oCPO_0,K^\oCPO_0,K^\oCPOR_0)$ is initial in $\oCPORT_k$. Thus, if
$T = (T^1,T^2,T^*) : \oCPORT_k \to \oCPORT_k$ is an endofunctor on
$\oCPORT_k$ then we can define the $\oCPO$ relation transformer
$\mu T$ to be $\colim{n < \omega_1}{T^n K_0}$.
It is not hard to see that $\mu T$ is given explicitly as 
\begin{equation}\label{eq:mu}
  \mu T = (\mu T^1,\mu T^2,
\colim{n < \omega_1}{(T^nK_0)^*})
\end{equation}
and that, as our notation suggests, it really is a fixpoint for $T$ if
$T$ is $\omega_1$-cocontinuous:
\begin{lemma}\label{lem:fp}
For any $T : [\oCPORT_k,\oCPORT_k]_{\omega_1}$, $\mu T \cong T(\mu T)$.
\end{lemma}
\noindent
The isomorphism is given by the morphisms $(\mathit{in}_1,
\mathit{in}_2) : T(\mu T) \to \mu T$ and $(in_1^{-1}, in_2^{-1}) : \mu
T \to T(\mu T)$ in $\oCPORT_k$. The latter is always a morphism in $\oCPORT_k$,
but the former need not be if $T$ is not $\omega_1$-cocontinuous.

It is worth noting that the third component in Equation~(\ref{eq:mu})
is the colimit in $[\oCPOR^k,\oCPOR]_{\omega_1}$ of third components
of $\oCPO$ relation transformers, rather than a fixpoint of an
endofunctor on $[\oCPO^k,\oCPO]_{\omega_1}$. That there is an
asymmetry between the first two components of $\mu T$ and its third
reflects the important conceptual observation that the third component
of an endofunctor on $\oCPORT_k$ need not be a functor on all of
$[\oCPOR^k,\oCPOR]_{\omega_1}$. In particular, although we can define
$T_{H,\rho}\, F$ for an $\oCPO$ relation transformer $F$ in
Definition~\ref{def:rel-sem} below, it is not clear how we could
define it for an arbitrary $F : [\oCPOR^k,\oCPOR]_{\omega_1}$.

\begin{dfn}\label{def:reln-env}
An {\em $\oCPO$ relation environment} maps each type variable in
$\tvars^k \cup \fvars^k$ to a $k$-ary $\oCPO$ relation
transformer.  A morphism $f : \rho \to \rho'$ between $\oCPO$
relation environments $\rho$ and $\rho'$ with $\rho|_\tvars =
\rho'|_\tvars$ maps each type constructor variable $\psi^k \in \tvars$
to the identity morphism on $\rho \psi^k = \rho' \psi^k$ and each
functorial variable $\phi^k \in \fvars$ to a morphism from the $k$-ary
$\oCPO$ relation transformer $\rho \phi$ to the $k$-ary
$\oCPO$ relation transformer $\rho' \phi$. Composition of
morphisms on $\oCPO$ relation environments is given
componentwise, with the identity morphism mapping each $\oCPO$
relation environment to itself. This gives a category of $\oCPO$
relation environments and morphisms between them, which we denote
$\oCPORenv$.
\end{dfn}

When convenient we identify a $0$-ary $\oCPO$ relation transformer
with the $\oCPO$ relation (transformer) that is its codomain and
consider an $\oCPO$ relation environment to map a type variable of
arity $0$ to an $\oCPO$ relation.  We write $\rho[\ol{\alpha := R}]$
for the $\oCPO$ relation environment $\rho'$ such that $\rho' \alpha_i
\, = R_i$ for $i = 1,...,k$ and $\rho' \alpha = \rho\alpha$ if $\alpha
\not \in \{\alpha_1,...,\alpha_k\}$.  If $\rho$ is an $\oCPO$ relation
environment, we write $\pi_1 \rho$ and $\pi_2 \rho$ for the $\oCPO$
environments mapping each type variable $\phi$ to the functors
$(\rho\phi)^1$ and $(\rho\phi)^2$, respectively.

We define, for each $k$, the notion of an $\omega_1$-cocontinuous
functor from $\oCPORenv$ to $\oCPORT_k$:
\begin{dfn}\label{def:relenv-functor}
A functor $H : [\oCPORenv, \oCPORT_k]_{\omega_1}$ is a triple $H =
(H^1,H^2,H^*)$, where
\begin{itemize}
\item $H^1$ and $H^2$ are objects in
  $[\oCPOenv,[\oCPO^k,\oCPO]_{\omega_1}]_{\omega_1}$
\item $H^*$ is a an object in
  $[\oCPORenv,[\oCPOR^k,\oCPOR]_{\omega_1}]_{\omega_1}$
\item for all $\overline{R : \oCPOR(A,B)}$ and morphisms $f$ in
  $\oCPORenv$, $\pi_1(H^*f \,{\overline{R}}) = H^1 (\pi_1
  f)\,{\overline{A}}$ and $\pi_2(H^*f \,{\overline{R}}) = H^2 (\pi_2
  f)\,{\overline{B}}$
\item The action of $H$ on $\rho$ in $\oCPORenv$ is given by $H \rho = (H^1
  (\pi_1 \rho),\,H^2 (\pi_2 \rho),\,H^*\rho)$
\item The action of $H$ on morphisms $f : \rho \to \rho'$ in $\oCPORenv$
  is given by $Hf = (H^1 (\pi_1 f),H^2 (\pi_2 f))$
\end{itemize}
\end{dfn}
\noindent Spelling out the last two bullet points above gives the
following analogues of the three conditions immediately following
Definition~\ref{def:RT-functor}: {\em i}) if $R_1 :
\oCPOR(A_1,B_1),...,R_k : \oCPOR(A_k,B_k)$, then $H^*\rho\, \ol{R} :
\oCPOR(H^1(\pi_1 \rho)\, \ol{A}, H^2(\pi_2 \rho)\, \ol{B})$; {\em ii})
if $(\alpha_1, \beta_1) \in \HomoCPOR(R_1,S_1),..., (\alpha_k,
\beta_k) \in \HomoCPOR(R_k,S_k)$, then $H^*\rho\, \ol{(\alpha, \beta)}
= (H^1(\pi_1 \rho)\,\ol{\alpha}, H^2(\pi_2 \rho)\, \ol{\beta})$; and
{\em iii}) if $f : \rho \to \rho'$ and
$R_1:\oCPOR(A_1,B_1),...,R_k:\oCPOR(A_k,B_k)$, then $(H^1(\pi_1
f)\,{\ol{A}}\,x, H^2(\pi_2 f)\,{\ol{B}}\,y) \in H^*\rho'\,\ol{R}$
whenever $(x, y) \in H^*\rho\,\ol{R}$. As before, the last condition
is automatically satisfied because it is implied by the third bullet
point of Definition~\ref{def:relenv-functor}.

Considering $\oCPORenv$ as a product $\Pi_{\phi^k \in \tvars \cup
  \fvars} \oCPORT_k$, we extend the computation of $\omega_1$-directed
colimits in $\oCPORT_k$ to compute colimits in $\oCPORenv$ componentwise. We
similarly extend the notion of an $\omega_1$-cocontinuous endofunctor on
$\oCPORT_k$ componentwise to give a notion of $\omega_1$-cocontinuity for
functors from $\oCPORenv$ to $\oCPORT_k$.  Recalling from the start of this
subsection that Definition~\ref{def:rel-sem} is given mutually
inductively with Definition~\ref{def:set-sem} we can, at last, define:

\begin{dfn}\label{def:rel-sem}
The {\em relational interpretation}
$\oCPORsem{\cdot} : \F \to [\oCPORenv, \oCPOR]_{\omega_1}$ is defined by
\begin{align*}
  \oCPORsem{\Gamma;\Phi \vdash \zerot}\rho &= 0\\
  \oCPORsem{\Gamma;\Phi \vdash \onet}\rho &= 1\\
  \oCPORsem{\Gamma; \emptyset \vdash \Nat^\Phi \,F\,G}\rho &= \{\eta
  : \lambda \ol{K}.\,\oCPORsem{\Gamma; \Phi \vdash
    F}\rho[\ol{\Phi := K}] \Rightarrow \lambda \ol{K}. \,\oCPORsem{
    \Gamma; \Phi \vdash G}\rho[\ol{\phi := K}]\}\\
  &=
  \{(t,t') \in \oCPOsem{\Gamma; \emptyset
    \vdash \Nat^\Phi
    \,F\,G} (\pi_1 \rho) \times \oCPOsem{ 
    \Gamma;\emptyset
    \vdash \Nat^\Phi \,F\,G} (\pi_2
  \rho)~|~\\ 
  & \hspace{0.3in} \forall \ol{K = (K^0, K^1, K^*) : \oCPORT_{k}}.\\
  & \hspace{0.4in} (t_{\ol{K^0}},t'_{\ol{K^1}}) \in
  (\oCPORsem{\Gamma; \Phi \vdash G}\rho[\ol{\Phi :=
      K}])^{\oCPORsem{\Gamma;\Phi\vdash F}\rho[\ol{\Phi := K}]} \}\\  
  \oCPORsem{\Gamma;\Phi \vdash \phi \ol{F}}\rho &=
  (\rho\phi)\ol{\oCPORsem{\Gamma;\Phi \vdash 
    F}\rho}\\
  \oCPORsem{\Gamma;\Phi \vdash F+G}\rho &=
  \oCPORsem{\Gamma;\Phi \vdash F}\rho +
  \oCPORsem{\Gamma;\Phi \vdash G}\rho\\
  \oCPORsem{\Gamma;\Phi \vdash F\times G}\rho &=
  \oCPORsem{\Gamma;\Phi \vdash F}\rho \times
  \oCPORsem{\Gamma;\Phi \vdash G}\rho\\  
   \oCPORsem{\Gamma;\Phi,\ol\gamma \vdash (\mu \phi.\lambda
    \ol{\alpha}. H)\ol{G}}\rho
  &= (\mu T_{H,\rho})\ol{\oCPORsem{\Gamma;\Phi,\ol\gamma \vdash
     G}\rho}\\
  \text{where }	T_{H,\rho}
    &= (T^\set_{H,\pi_1\rho}, T^\set_{H,\pi_2\rho}, T^\rel_{H,\rho}) \\
  \text{and } T^\oCPOR_{H,\rho}\,F
    &= \lambda \ol{R}. \oCPORsem{
      \Gamma;\ol\gamma,\phi,\ol{\alpha} \vdash H}\rho[\phi :=
    F][\ol{\alpha := R}]\\
  \text{and } T^\oCPOR_{H,\rho}\,\delta
    &= \lambda \ol{R}. \oCPORsem{
      \Gamma;\ol\gamma,\phi,\ol{\alpha} \vdash H}\id_\rho[\phi :=
    \delta][\ol{\alpha := \id_{\ol{R}}}] \\
  \oCPORsem{\Gamma;\Phi \vdash (\Lan^{\ol{\alpha}}_{\ol{K}} F)\ol{A}}\rho &=
    (\textit{Lan}_{\ol{\oCPORsem{\Gamma; \ol\alpha \vdash K}\rho[\ol{\alpha := \_}]}}
      \oCPORsem{\Gamma; \Phi, \ol\alpha \vdash F}\rho[\ol{\alpha := \_}])
    \ol{\oCPORsem{\Gamma; \Phi \vdash A}\rho}
\end{align*}
\end{dfn}

For Definition~\ref{def:rel-sem} to be well-defined, we have to check
that each relational interpretation is in $\oCPOR$ and, in particular,
that each relates sups of pairwise related $\omega$-chains. This will
be proved by induction on types, and in most cases it will follow from
the induction hypotheses. However, well-definedness needs to be proved
directly for relational interpretations of $\Nat$-types.

The proof that relational interpretations of $\Nat$-types define sets
is analogous to the proof of Lemma~\ref{lem:nat-types-sets}.  Next, we
observe that $\oCPORsem{\Gamma; \emptyset \vdash \Nat^\Phi F\,G} \rho$
is in $\oCPOR$. It is indeed a relation between $\oCPO$s, and it
relates sups of pairwise related $\omega$-chains of natural
transformations because their sups are computed pointwise. More
specifically, if $(t_i, t_i') \colon \oCPORsem{\Gamma; \emptyset
  \vdash \Nat^\Phi F\,G} \rho$ for all $i < \omega$, then for every
$\ol{K = (K^1, K^2, K^*) : \oCPORT_{k}}$ and every $i < \omega$ we
have
  \[\big((t_i)_{\ol{K^1}},\, (t'_i)_{\ol{K^2}}\big) \in
  (\oCPORsem{\Gamma; \Phi \vdash G}\rho[\ol{\Phi :=
      K}])^{\oCPORsem{\Gamma;\Phi\vdash F}\rho[\ol{\Phi := K}]}\] So
  if $(a,b) \in \oCPORsem{\Gamma;\Phi\vdash F}\rho[\ol{\Phi := K}]$,
  then $\big((t_i)_{\ol{K^1}}\,a,\, (t'_i)_{\ol{K^2}}\,b\big) \in
  \oCPORsem{\Gamma;\Phi\vdash G}\rho[\ol{\Phi := K}]$ for all $i <
  \omega$. But then since $\big((t_i)_{\ol{K^1}} a\big)_{i < \omega}$
  is an $\omega$-chain in $\oCPOsem{\Gamma; \Phi \vdash
    G}\rho[\ol{\Phi := K^1}]$ and $\big((t'_i)_{\ol{K^2}}\big)_{i <
    \omega} b$ is an $\omega$-chain in $\oCPOsem{\Gamma; \Phi \vdash
    G}\rho[\ol{\Phi := K^2}]$, not only are $\bigvee_{i < \omega}
  ((t_i)_{\ol{K^1}}\,a)$ and $\bigvee_{i < \omega}
  ((t'_i)_{\ol{K^2}}\,b)$ well-defined, but, since
\[\oCPORsem{\Gamma;\Phi\vdash G}\rho[\ol{\Phi := K}] : \oCPOR(
  \oCPOsem{\Gamma;\Phi\vdash G}\rho[\ol{\Phi := K^1}],
  \oCPOsem{\Gamma;\Phi\vdash G}\rho[\ol{\Phi := K^2}])\]
we have
  \[
  \Big(\big(\bigvee_{i < \omega} t_i\big)_{\ol{K^1}} \,a,
  \big(\bigvee_{i < \omega} t'_i\big)_{\ol{K^2}} \,b\Big)
  = \Big(\bigvee_{i < \omega} \big((t_i)_{\ol{K^1}}\,a\big),\,
  \bigvee_{i < \omega} \big((t'_i)_{\ol{K^2}}\,b\big)\Big) \in
          \oCPORsem{\Gamma;\Phi\vdash G}\rho[\ol{\Phi
             := K}]\] as well. That is,
\[
  \Big(\big(\bigvee_{i < \omega} t_i\big)_{\ol{K^1}}, \big(\bigvee_{i
    < \omega} t'_i\big)_{\ol{K^2}} \Big)
  \in (\oCPORsem{\Gamma;
    \Phi \vdash G}\rho[\ol{\Phi := K}])^{\oCPORsem{\Gamma;\Phi\vdash
      F}\rho[\ol{\Phi := K}]}
  \]
i.e.,
$( \bigvee_{i < \omega} t_i, \bigvee_{i < \omega} t'_i ) \in
  \oCPORsem{\Gamma; \emptyset \vdash \Nat^\Phi F\,G} \rho$.

Moreover, as for $\oCPO$ interpretations, $\omega_1$-cocontinuity of
each of the above interpretations follows from Corollary~12
of~\cite{jp19} if we \new{APPROPRIATELY RESTRICT THE SUBSCRIPTS of
$\Lan$s}. For $\Nat$-types, $\oCPORsem{\Gamma; \emptyset \vdash
  \Nat^\Phi F\,G}$ is an $\omega_1$-cocontinuous functor because it is
constant on $\omega_1$-directed sets.  Interpretations of $\Nat$-types
ensure that $\oCPORsem{\Gamma \vdash F \to G}$ and $\oCPORsem{\Gamma
  \vdash \forall \ol \alpha. F}$ are as expected in any parametric
model.

For the next-to-last clause in Definition~\ref{def:rel-sem} to be
well-defined we need $T_{H,\rho}$ to be an $\omega_1$-cocontinuous
endofunctor on $\oCPORT$ so that, by Lemma~\ref{lem:fp}, it admits a
fixpoint.  Since $T_{H,\rho}$ is defined in terms of
$\oCPORsem{\Gamma;\ol\gamma,\phi^k, \ol{\alpha} \vdash H}$, this means
that relational interpretations of types must be
$\omega_1$-cocontinuous functors from $\oCPORenv$ to $\oCPORT_0$,
which in turn entails that the actions of relational interpretations
of types on objects and on morphisms in $\oCPORenv$ are intertwined.
%Moreover, for the last clause in Definition~\ref{def:rel-sem} to be
%well-defined we need $\oCPORsem{\Gamma; \ol\alpha \vdash
%  K}\rho[\ol{\alpha := \_}]$ and $\oCPORsem{\Gamma; \Phi, \ol\alpha
%  \vdash F}\rho[\ol{\alpha := \_}]$ to be $\omega_1$-cocontinuous
%functors.
As for $\oCPO$ interpretations, we know from~\cite{jp19} that, for
every $\Gamma; \ol\alpha \vdash F$, $\oCPORsem{\Gamma; \ol\alpha
  \vdash F}$ is actually in $[\oCPOR^k,\oCPOR]_{\omega_1}$, where $k =
|\ol\alpha|$. We first define the actions of each of these functors
on morphisms between $\oCPO$ relation environments in
Definition~\ref{def:rel-sem-funcs}, and then argue that the functors
given by Definitions~\ref{def:rel-sem} and~\ref{def:rel-sem-funcs} are
well-defined and have the required properties. To do this, we extend
$T_H$ to a {\em functor} from $\oCPORenv$ to
$[[\oCPOR^k,\oCPOR]_{\omega_1},
  [\oCPOR^k,\oCPOR]_{\omega_1}]_{\omega_1}$.  Its action on an object
$\rho \in \oCPORenv$ is given by the higher-order functor $T_{H,\rho}$
whose actions on objects and morphisms are given in
Definition~\ref{def:rel-sem-funcs}. Its action on a morphism $f : \rho
\to \rho'$ is the higher-order natural transformation $T_{H,f} :
T_{H,\rho} \to T_{H,\rho'}$ whose action on any $F :
[\oCPOR^k,\oCPOR]_{\omega_1}$ is the higher-order natural
transformation $T_{H,f}\, F : T_{H,\rho}\, F \to T_{H,\rho'}\, F$
whose component at $\ol{R}$ is $(T_{H,f}\, F)_{\ol{R}} =
\oCPORsem{\Gamma; \ol\gamma,\phi,\ol{\alpha} \vdash H}f[\phi :=
  \id_F][\ol{\alpha := \id_R}]$. The next definition uses $T_H$ to
define the actions of functors interpreting types on morphisms between
$\oCPO$ relation environments.

If $\rho \in \oCPORenv$ and $\vdash F$, then we write
$\oCPORsem{\vdash F}$ instead of $\oCPORsem{\vdash F}\rho$. The
interpretations in Definitions~\ref{def:rel-sem} and in
Definition~\ref{def:rel-sem-funcs} below respect weakening.

\begin{dfn}\label{def:rel-sem-funcs}
Let $f: \rho \to \rho'$ for $\oCPO$ relation environments $\rho$ and
$\rho'$ (so that $\rho|_\tvars = \rho'|_\tvars$). The action
$\oCPORsem{\Gamma;\Phi \vdash F}f$ of $\oCPORsem{\Gamma;\Phi \vdash
  F}$ on the morphism $f$ is given exactly as in
Definition~\ref{def:set-sem-funcs}, except that all interpretations
are $\oCPO$ relational interpretations and all occurrences of
$T^\oCPO_{H,f}$ are replaced by $T_{H,f}$.
\end{dfn}

To see that the functors given by Definitions~\ref{def:rel-sem}
and~\ref{def:rel-sem-funcs} are well-defined we must show that, for
every $H$, $T_{H,\rho}\,F$ is an $\oCPO$ relation transformer for any
$\oCPO$ relation transformer $F$, and that $T_{H,f}\, F : T_{H,\rho}\,
F \to T_{H,\rho'}\, F$ is a morphism of $\oCPO$ relation transformers
for every $\oCPO$ relation transformer $F$ and every morphism $f :
\rho \to \rho'$ in $\oCPORenv$. This is an immediate consequence of
the following Lemma.

\begin{lemma}\label{lem:rel-transf-morph}
For every $\Gamma;\Phi \vdash F$, $\sem{\Gamma;\Phi \vdash F} =
(\oCPOsem{\Gamma;\Phi \vdash F}, \oCPOsem{\Gamma;\Phi \vdash
  F},\oCPORsem{\Gamma;\Phi \vdash F}) \in
[\oCPORenv,\oCPORT_0]_{\omega_1}$.
\end{lemma}
\noindent
The proof is a straightforward induction on the structure of $F$,
using an appropriate result from~\cite{jp19} to deduce
$\omega_1$-cocontinuity of $\sem{\Gamma;\Phi \vdash F}$ in each case,
together with Lemma~\ref{lem:fp} and Equation~\ref{eq:mu} for
$\mu$-types. \new{$\Lan$ types need restriction on their
  subscripts.}

We can also prove by simultaneous induction that our interpretations
of types interact well with demotion of functorial variables. Indeed,
we have that, if $\rho, \rho' : \oCPOenv$, \,$f : \rho \to \rho'$,
\,$\rho \phi = \rho \psi = \rho' \phi = \rho' \psi$, \, $f \phi = f
\psi = \id_{\rho \phi}$,\, $\Gamma; \Phi, \phi^k \vdash F$,\,
$\Gamma;\Phi,\ol{\alpha} \vdash G$,\, $\Gamma;\Phi,\alpha_1...\alpha_k
\vdash H$, and $\ol{\Gamma;\Phi \vdash K}$, then
\begin{gather}
\label{thm:demotion-objects}
\oCPOsem{\Gamma; \Phi, \phi \vdash F} \rho = \oCPOsem{\Gamma, \psi; \Phi
  \vdash F[\phi :== \psi] } \rho\\
\label{thm:demotion-morphisms}
\oCPOsem{\Gamma; \Phi, \phi \vdash F} f = \oCPOsem{\Gamma, \psi; \Phi
  \vdash F[\phi :== \psi]} f\\
%\end{gather}
%Moreover,
%\begin{lemma}\label{lem:demotion-objects}
%\begin{gather}
%\label{thm:demotion-objects}
%\setsem{\Gamma; \Phi, \phi \vdash F} \rho = \setsem{\Gamma, \psi; \Phi
%  \vdash F[\phi :== \psi] } \rho{\color{blue}[\psi := \rho \phi]}\\
%\label{thm:demotion-morphisms}
%\setsem{\Gamma; \Phi, \phi \vdash F} f = \setsem{\Gamma, \psi; \Phi
%  \vdash F[\phi :== \psi]} f{\color{blue}[\psi \mapsto f\phi]}\\
\label{eq:subs-var}
\oCPOsem{\Gamma;\Phi \vdash G[\ol{\alpha := K}]}\rho =
\oCPOsem{\Gamma;\Phi,\ol{\alpha} \vdash G}\rho[\ol{\alpha := 
\oCPOsem{\Gamma;\Phi \vdash K}\rho}]\\
\label{eq:subs-var-morph}
\oCPOsem{\Gamma;\Phi \vdash G[\ol{\alpha := K}]}f =
\oCPOsem{\Gamma;\Phi,\ol{\alpha} \vdash G}f[\ol{\alpha :=
\oCPOsem{\Gamma;\Phi \vdash K}f}]\\
\label{eq:subs-const}
\oCPOsem{\Gamma; \Phi \vdash F[\phi := H]}\rho
= \oCPOsem{\Gamma; \Phi, \phi \vdash F}\rho
[\phi := \lambda \ol{A}.\, \oCPOsem{\Gamma;\Phi,\overline{\alpha}\vdash
    H}\rho[\overline{\alpha := A}]] \\ 
\label{eq:subs-const-morph}
\oCPOsem{\Gamma; \Phi \vdash F[\phi := H]}f
= \oCPOsem{\Gamma; \Phi, \phi \vdash F}f
[\phi := \lambda \ol{A}.\,\oCPOsem{\Gamma;\Phi,\overline{\alpha}\vdash
    H}f[\overline{\alpha := \id_{\ol{A}}}]] 
\end{gather}
Identities analogous to (\ref{thm:demotion-objects}) through
(\ref{eq:subs-const-morph}) hold for $\oCPO$ relational
interpretations as well.
  





\vspace*{1in}

\hrule

\vspace*{0.1in}

\new{
Some questions/issues:
\begin{itemize}
\item Can we write zipBush and appendBush with $\partial$ and $\int$?
  We could already represent the uncurried type of appendBush
  (although not its curried type), but couldn't recurse over both
  input bushes because folds take natural transformations as inputs.
\item More generally, how do we compute with $\partial$ and $\int?$
  Can we use the colimit formulation of Lans (see Lemma 6.3.7
  of~\cite{rie16}) to get a handle on this?
\item What is the connection between exponentials and natural
  transformations? (Should we assume only small objects are
  exponentiable?) Do we want the former or the latter for
  computational purposes? (I suspect the latter.)

  [From nlab:
  In a functor category $D^C$ , a natural transformation $\alpha : F \to
  G$ is exponentiable if (though probably not ``only if'') it is
  cartesian and each component $\alpha_c : F c \to G c$ is
  exponentiable in $D$.  Given $H \to F$ we define $(\Pi_\alpha H) c =
  \Pi_{\alpha_c}(Hc)$; then for $u : c \to c'$ to obtain a map
  $\Pi_{\alpha_c} (Hc) \to \Pi_{\alpha_{c'}} (Hc')$ we need a map
  $\alpha^*_{c'}(\Pi_{\alpha_c}(Hc)) \to Hc'$. But since $\alpha$ is
  cartesian, $\alpha^*_{c'}(\Pi_{\alpha_c}(Hc)) \cong
  \alpha^*_{c}(\Pi_{\alpha_c}(Hc))$, so we have the counit
  $\alpha^*_{c}(\Pi_{\alpha_c}(Hc)) \to Hc$ that we can compose with
  $Hu$.]
\item After we understand what we can do with Lans and folds on GADTs
  we might want to try to extend calculus with term-level
  fixpoints. This would give a categorical analogue for GADTs
  of~\cite{pit98,pit00} for ADTs. Would it also more accurately
  reflect how GADTs are used in practice, or are functions over GADTs
  usually folds? Investigate applications in the literature and/or in
  implementations.
\item $\omega$CPO is a natural choice for modeling general
  recursion. We know $(Lan^\gamma_C \onet)D$ is $C \to D$ for any
  closed type $C$. (Also for select classes of open types?) So can
  model $\Nat \to \gamma$. But the functor $NX = \Nat \to X$ isn't
  $\omega$-cocontinuous. It also doesn't preserve
  $\omega_1$-presentable objects, i.e., countable $\omega$CPOs since
  $\Nat \to \Nat$ is not countable. So we cannot have a functor like
  $N$ as the subscript to $\Lan$ and expect the resulting $\Lan$ to be
  $\omega_1$-cocontinuous.
\item What functors can be subscripts to $\Lan$ and produce
  $\omega_1$-cocontinuous functors? We can use functors that preserve
  presentable objects by theorem in~\cite{jp19}, and possibly others
  as well. These include polynomial functors, ADTs and nested types
  seen as functors, certain (which?) GADTs seen as functors? How big
  can GADTs get? 
\end{itemize}
}

\bibliography{references}

\end{document}
